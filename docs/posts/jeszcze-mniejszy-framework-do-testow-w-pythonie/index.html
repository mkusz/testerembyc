<!DOCTYPE html>
<html lang="pl" prefix="og: http://ogp.me/ns#">
<head>
<meta content="#FF0000" name="theme-color">
<meta charset="utf-8">
<meta content="PotÄ™gi Pythona ciÄ…g dalszy" name="description">
<meta content="width=device-width, initial-scale=1" name="viewport">
<title>Jeszcze mniejszy framework do testÃ³w w Pythonie | testerembyc.pl</title>
<link href="../../assets/css/bootstrap.min.css" rel="stylesheet" type="text/css">
<link href="../../assets/css/rst.css" rel="stylesheet" type="text/css">
<link href="../../assets/css/code.css" rel="stylesheet" type="text/css">
<link href="../../assets/css/baguetteBox.min.css" rel="stylesheet" type="text/css">
<link href="../../assets/css/theme.css" rel="stylesheet" type="text/css">
<link href="../../assets/css/latolatinfonts.css" rel="stylesheet" type="text/css">
<link href="../../assets/css/blog.css" rel="stylesheet" type="text/css">
<link href="../../assets/css/fa.css" rel="stylesheet" type="text/css">
<link href="../../rss.xml" rel="alternate" title="RSS" type="application/rss+xml">
<link href="https://testerembyc.pl/posts/jeszcze-mniejszy-framework-do-testow-w-pythonie/" rel="canonical">
<link href="../../images/icons/icon_16x16.png" rel="icon" sizes="16x16">
<link href="../../images/icons/icon_32x32.png" rel="icon" sizes="32x32">
<link href="../../images/icons/icon_64x64.png" rel="icon" sizes="64x64">
<link href="../../images/icons/icon_128x128.png" rel="icon" sizes="128x128">
<link href="../../images/icons/icon_256x256.png" rel="icon" sizes="256x256">
<link href="../../images/icons/icon_512x512.png" rel="icon" sizes="512x512"><!--[if lt IE 9]><script src="../../assets/js/html5.js"></script><![endif]-->
<meta content="PotÄ™gi Pythona ciÄ…g dalszy" itemprop="description" name="description">
<meta content="Maciej Kusz" name="author">
<link href="../20201218/najmniejszy-framework-do-testow-w-pythonie/" rel="prev" title="Najmniejszy framework do testÃ³w w Pythonie" type="text/html">
<meta content="testerembyc.pl" property="og:site_name">
<meta content="Jeszcze mniejszy framework do testÃ³w w Pythonie" property="og:title">
<meta content="https://testerembyc.pl/posts/jeszcze-mniejszy-framework-do-testow-w-pythonie/" property="og:url">
<meta content="PotÄ™gi Pythona ciÄ…g dalszy" property="og:description">
<meta content="https://testerembyc.pl/images/posts/jeszcze-mniejszy-framework-do-testow-w-pythonie.jpg" property="og:image">
<meta content="article" property="og:type">
<meta content="2021-01-06T20:53:56+01:00" property="article:published_time">
<meta content="lambda" property="article:tag">
<meta content="python" property="article:tag">
<meta content="requests" property="article:tag">
<meta content="unittest" property="article:tag">
<meta content="summary" name="twitter:card">
<meta content="@website" name="twitter:site">
<meta content="@username" name="twitter:creator">
</head>
<body>
<a class="sr-only sr-only-focusable" href="#content">PrzejdÅº do treÅ›ci</a> <!-- Menubar -->
<div class="blog-masthead">
<div class="container"><!-- This keeps the margins nice -->
<div class="blog-header">
<h1 class="blog-title"><a href="https://testerembyc.pl/"><img alt="testerembyc.pl" id="logo" src="../../images/testerembyc_logo.svg"><span id="blog-title">testerembyc.pl</span></a></h1>
<!-- <p class="lead blog-description">Czyli blog o tym, jak to jest byÄ‡ nie tylko testerem</p> # Oryginal one-->
<p class="lead blog-description">Czyli blog o tym, jak to jest byÄ‡ nie tylko <span>testerem</span></p>
</div>
<nav class="blog-nav" role="navigation"><a class="blog-nav-item" href="../../"><img height="16" src="../../images/icons/icon.svg" title="Strona gÅ‚Ã³wna" width="16"><span>Strona&nbsp;gÅ‚Ã³wna</span></a> <a class="blog-nav-item" href="../../archive.html"><i class="fas fa-archive" title="Archiwum"></i><span>Archiwum</span></a> <a class="blog-nav-item" href="../../categories/"><i class="fas fa-tags" title="Tagi i kategorie"></i><span>Tagi&nbsp;i&nbsp;kategorie</span></a> <a class="blog-nav-item" href="../../pages/o-mnie/"><i class="fas fa-user" title="O mnie"></i><span>O&nbsp;mnie</span></a> <a class="blog-nav-item" href="../../rss.xml"><i class="fas fa-rss" title="RSS"></i><span>RSS</span></a></nav>
<!-- START Bootstrap-Cookie-Alert -->
<div class="alert text-center cookiealert" role="alert">
<p><b>Lubisz ciasteczka?</b> ğŸª</p>
<p>UÅ¼ywam ich, aby dostarczyÄ‡ Ci lepszych treÅ›ci. Chcesz wiedzieÄ‡ wiÄ™cej? <a href="../../pages/polityka-prywatnosci/" target="_blank">Kliknij tu.</a></p>
<p><button class="btn btn-danger btn-sm acceptcookies" type="button">LubiÄ™ i akceptujÄ™ ciasteczka</button></p>
</div>
<!-- END Bootstrap-Cookie-Alert -->
<div class="body-content"><!--Body content-->
<div class="row">
<div class="col-sm-9 blog-main">
<article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article">
<header>
<h2 class="p-name entry-title blog-post-title" itemprop="headline name"><a class="u-url" href=".">Jeszcze mniejszy framework do testÃ³w w Pythonie</a></h2>
<div class="metadata blog-post-meta">
<p class="byline author vcard"><span class="byline-name fn">Maciej Kusz</span></p>
<p class="dateline"><a href="." rel="bookmark"><time class="published dt-published" datetime="2021-01-06T20:53:56+01:00" itemprop="datePublished" title="2021-01-06 20:53">2021-01-06 20:53</time></a></p>
<p class="commentline"><a data-disqus-identifier="cache/posts/jeszcze-mniejszy-framework-do-testow-w-pythonie.html" href="#disqus_thread">Komentarze</a></p>
<meta content="PotÄ™gi Pythona ciÄ…g dalszy" itemprop="description" name="description">
<p></p></div>
</header>
<div class="e-content entry-content" itemprop="articleBody text">
<div>
<div class="figure align-center"><a class="reference external image-reference" href="."><img alt="/images/posts/jeszcze-mniejszy-framework-do-testow-w-pythonie.jpg" src="../../images/posts/jeszcze-mniejszy-framework-do-testow-w-pythonie.jpg"></a>
<p class="caption">ZdjÄ™cie zaczerpniÄ™te z portalu <a class="reference external" href="https://www.pexels.com/">Pexels</a></p>
</div>
<p>PoniÅ¼szy wpis jest kontynuacjÄ… poprzedniego wpisu, gdzie prÃ³bowaÅ‚em pokazaÄ‡ Ci jak w Pythonie moÅ¼na stworzyÄ‡ <a class="reference external" href="../20201218/najmniejszy-framework-do-testow-w-pythonie/">najmniejszy framework do testÃ³w</a>.</p>
<p>Czym siÄ™ dzisiaj wspÃ³lnie zajmiemy?</p>
<p>OtÃ³Å¼ odpowiemy sobie na 2 pytania:</p>
<ul class="simple">
<li>
<p>Czy aby na pewno 16 linijek kodu, to najmniejsza moÅ¼liwa iloÅ›Ä‡?</p>
</li>
<li>
<p>Czy da siÄ™ w tych 16 linijkach kodu stworzyÄ‡ bardziej rozbudowany framework?</p>
</li>
</ul>
<p>Odpowiedzi na te pytania zapewne siÄ™ domyÅ›lasz, ale jeÅ›li chcesz wiedzieÄ‡ jak, to nie pozostaje Ci nic innego jak zagÅ‚Ä™biÄ‡ siÄ™ w dalszÄ… czÄ™Å›Ä‡ tego wpisu.</p>
<!-- more -->
<div class="section" id="gdzie-skonczylismy">
<h2>Gdzie skoÅ„czyliÅ›my?<a class="headerlink" href="#gdzie-skonczylismy" title="Permalink to this heading">Â¶</a></h2>
<p>Dla maÅ‚ego przypomnienia zacznijmy w miejscu, gdzie skoÅ„czyliÅ›my. Kod naszego mini frameworka wyglÄ…da tak:</p>
<pre class="code python"><a id="rest_code_76a3f8154eb94c34bfba6643fed22af5-1" name="rest_code_76a3f8154eb94c34bfba6643fed22af5-1"></a><span class="kn">import</span> <span class="nn">unittest</span><span class="o">,</span> <span class="nn">xmlrunner</span><span class="o">,</span> <span class="nn">json</span><span class="o">,</span> <span class="nn">requests</span>
<a id="rest_code_76a3f8154eb94c34bfba6643fed22af5-2" name="rest_code_76a3f8154eb94c34bfba6643fed22af5-2"></a>
<a id="rest_code_76a3f8154eb94c34bfba6643fed22af5-3" name="rest_code_76a3f8154eb94c34bfba6643fed22af5-3"></a><span class="k">class</span> <span class="nc">Tests</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span> <span class="k">pass</span>
<a id="rest_code_76a3f8154eb94c34bfba6643fed22af5-4" name="rest_code_76a3f8154eb94c34bfba6643fed22af5-4"></a>
<a id="rest_code_76a3f8154eb94c34bfba6643fed22af5-5" name="rest_code_76a3f8154eb94c34bfba6643fed22af5-5"></a><span class="k">def</span> <span class="nf">add_test</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
<a id="rest_code_76a3f8154eb94c34bfba6643fed22af5-6" name="rest_code_76a3f8154eb94c34bfba6643fed22af5-6"></a>    <span class="k">def</span> <span class="nf">abstract_test</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="rest_code_76a3f8154eb94c34bfba6643fed22af5-7" name="rest_code_76a3f8154eb94c34bfba6643fed22af5-7"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">requests</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="o">**</span><span class="n">data</span><span class="p">[</span><span class="s1">'request'</span><span class="p">])</span><span class="o">.</span><span class="n">status_code</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="s1">'assert'</span><span class="p">][</span><span class="s1">'statusCode'</span><span class="p">])</span>
<a id="rest_code_76a3f8154eb94c34bfba6643fed22af5-8" name="rest_code_76a3f8154eb94c34bfba6643fed22af5-8"></a>    <span class="nb">setattr</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">abstract_test</span><span class="p">)</span>
<a id="rest_code_76a3f8154eb94c34bfba6643fed22af5-9" name="rest_code_76a3f8154eb94c34bfba6643fed22af5-9"></a>
<a id="rest_code_76a3f8154eb94c34bfba6643fed22af5-10" name="rest_code_76a3f8154eb94c34bfba6643fed22af5-10"></a><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">'tests.json'</span><span class="p">,</span> <span class="s1">'r'</span><span class="p">)</span> <span class="k">as</span> <span class="n">json_file</span><span class="p">:</span>
<a id="rest_code_76a3f8154eb94c34bfba6643fed22af5-11" name="rest_code_76a3f8154eb94c34bfba6643fed22af5-11"></a>    <span class="k">for</span> <span class="n">test_name</span><span class="p">,</span> <span class="n">test_data</span> <span class="ow">in</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">json_file</span><span class="p">)</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="rest_code_76a3f8154eb94c34bfba6643fed22af5-12" name="rest_code_76a3f8154eb94c34bfba6643fed22af5-12"></a>        <span class="n">add_test</span><span class="p">(</span><span class="n">Tests</span><span class="p">,</span> <span class="n">test_name</span><span class="p">,</span> <span class="n">test_data</span><span class="p">)</span>
<a id="rest_code_76a3f8154eb94c34bfba6643fed22af5-13" name="rest_code_76a3f8154eb94c34bfba6643fed22af5-13"></a>
<a id="rest_code_76a3f8154eb94c34bfba6643fed22af5-14" name="rest_code_76a3f8154eb94c34bfba6643fed22af5-14"></a><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">'__main__'</span><span class="p">:</span>
<a id="rest_code_76a3f8154eb94c34bfba6643fed22af5-15" name="rest_code_76a3f8154eb94c34bfba6643fed22af5-15"></a>    <span class="n">unittest</span><span class="o">.</span><span class="n">main</span><span class="p">(</span><span class="n">testRunner</span><span class="o">=</span><span class="n">xmlrunner</span><span class="o">.</span><span class="n">XMLTestRunner</span><span class="p">())</span>
</pre></div>
<div class="section" id="w-pogoni-za-rozumem">
<h2>W pogoni za rozumem<a class="headerlink" href="#w-pogoni-za-rozumem" title="Permalink to this heading">Â¶</a></h2>
<div class="section" id="kosmetyka">
<h3>Kosmetyka<a class="headerlink" href="#kosmetyka" title="Permalink to this heading">Â¶</a></h3>
<p>PÃ³ki co nasz kod jest w miarÄ™ czytelny, pomimo zÅ‚amania kilku reguÅ‚. Skoro i tak je Å‚amiemy, to idÅºmy ciut gÅ‚Ä™biej i uproÅ›Ä‡my ten kod do poniÅ¼szej postaci.</p>
<pre class="code python"><a id="rest_code_ff86348c962248138e10dc47f01dd6eb-1" name="rest_code_ff86348c962248138e10dc47f01dd6eb-1"></a><span class="kn">import</span> <span class="nn">unittest</span><span class="o">,</span> <span class="nn">xmlrunner</span><span class="o">,</span> <span class="nn">json</span><span class="o">,</span> <span class="nn">requests</span>
<a id="rest_code_ff86348c962248138e10dc47f01dd6eb-2" name="rest_code_ff86348c962248138e10dc47f01dd6eb-2"></a>
<a id="rest_code_ff86348c962248138e10dc47f01dd6eb-3" name="rest_code_ff86348c962248138e10dc47f01dd6eb-3"></a><span class="k">def</span> <span class="nf">add_test</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
<a id="rest_code_ff86348c962248138e10dc47f01dd6eb-4" name="rest_code_ff86348c962248138e10dc47f01dd6eb-4"></a>    <span class="k">def</span> <span class="nf">abstract_test</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="rest_code_ff86348c962248138e10dc47f01dd6eb-5" name="rest_code_ff86348c962248138e10dc47f01dd6eb-5"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">requests</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="o">**</span><span class="n">data</span><span class="p">[</span><span class="s1">'request'</span><span class="p">])</span><span class="o">.</span><span class="n">status_code</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="s1">'assert'</span><span class="p">][</span><span class="s1">'statusCode'</span><span class="p">])</span>
<a id="rest_code_ff86348c962248138e10dc47f01dd6eb-6" name="rest_code_ff86348c962248138e10dc47f01dd6eb-6"></a>    <span class="nb">setattr</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">abstract_test</span><span class="p">)</span>
<a id="rest_code_ff86348c962248138e10dc47f01dd6eb-7" name="rest_code_ff86348c962248138e10dc47f01dd6eb-7"></a>
<a id="rest_code_ff86348c962248138e10dc47f01dd6eb-8" name="rest_code_ff86348c962248138e10dc47f01dd6eb-8"></a><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">'tests.json'</span><span class="p">,</span> <span class="s1">'r'</span><span class="p">)</span> <span class="k">as</span> <span class="n">json_file</span><span class="p">:</span>
<a id="rest_code_ff86348c962248138e10dc47f01dd6eb-9" name="rest_code_ff86348c962248138e10dc47f01dd6eb-9"></a>    <span class="k">class</span> <span class="nc">Tests</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span> <span class="k">pass</span>
<a id="rest_code_ff86348c962248138e10dc47f01dd6eb-10" name="rest_code_ff86348c962248138e10dc47f01dd6eb-10"></a>    <span class="k">for</span> <span class="n">test_name</span><span class="p">,</span> <span class="n">test_data</span> <span class="ow">in</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">json_file</span><span class="p">)</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="rest_code_ff86348c962248138e10dc47f01dd6eb-11" name="rest_code_ff86348c962248138e10dc47f01dd6eb-11"></a>        <span class="n">add_test</span><span class="p">(</span><span class="n">Tests</span><span class="p">,</span> <span class="n">test_name</span><span class="p">,</span> <span class="n">test_data</span><span class="p">)</span>
<a id="rest_code_ff86348c962248138e10dc47f01dd6eb-12" name="rest_code_ff86348c962248138e10dc47f01dd6eb-12"></a>
<a id="rest_code_ff86348c962248138e10dc47f01dd6eb-13" name="rest_code_ff86348c962248138e10dc47f01dd6eb-13"></a><span class="n">unittest</span><span class="o">.</span><span class="n">main</span><span class="p">(</span><span class="n">testRunner</span><span class="o">=</span><span class="n">xmlrunner</span><span class="o">.</span><span class="n">XMLTestRunner</span><span class="p">())</span>
</pre>
<p>Zmian jest niewiele i to tylko kosmetyka:</p>
<ul class="simple">
<li>
<p>usunÄ™liÅ›my sprawdzanie z jakiego skryptu jest uruchamiany nasz kod,</p>
</li>
<li>
<p>przerzuciliÅ›my definicjÄ™ klasy <code>Test</code> do wnÄ™trza bloku <code>with open(...)</code>.</p>
</li>
</ul>
<p>PowyÅ¼sza kosmetyka redukujÄ™ iloÅ›Ä‡ linii kodu do 13.</p>
<p>PatrzÄ…c na kod, moÅ¼emy zauwaÅ¼yÄ‡, Å¼e jednym z wiÄ™kszych blokÃ³w jest definicja funkcji <code>add_test</code>. ZastanÃ³wmy siÄ™ czy da siÄ™ coÅ› z tym tematem zrobiÄ‡.</p>
</div>
<div class="section" id="wyrazenia-lambda">
<h3>WyraÅ¼enia Lambda<a class="headerlink" href="#wyrazenia-lambda" title="Permalink to this heading">Â¶</a></h3>
<p>Zanim jednak bÄ™dziemy bardziej odchudzaÄ‡ kod frameworku, musimy poznaÄ‡ czym sÄ… tzw. <strong>wyraÅ¼enia Lambda</strong> w Pythonie.</p>
<p><strong>WyraÅ¼enia Lmabda</strong> to krÃ³tki, anonimowe funkcje (opisane w <a class="reference external" href="https://www.python.org/dev/peps/pep-0312/">PEP 312</a> oraz <a class="reference external" href="https://docs.python.org/3/tutorial/controlflow.html#lambda-expressions">dokumentacji</a>). Funkcje takie sÄ… okreÅ›lane jako anonimowe poniewaÅ¼ zdefiniowane sÄ… w miejscu ich uÅ¼ycia. <strong>Funkcje Lambda</strong> mogÄ… przyjmowaÄ‡ dowolnÄ… liczbÄ™ argumentÃ³w ale mogÄ… zawieraÄ‡ tylko jedno wyraÅ¼enie. Ale jak dziaÅ‚a Lambda?</p>
<p>Zacznijmy od czegoÅ› prostego, czyli suma 2 liczb:</p>
<pre class="code python"><a id="rest_code_b02ea3c2b3d64f1f9ed0385e5ae3693c-1" name="rest_code_b02ea3c2b3d64f1f9ed0385e5ae3693c-1"></a><span class="n">add</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span>
<a id="rest_code_b02ea3c2b3d64f1f9ed0385e5ae3693c-2" name="rest_code_b02ea3c2b3d64f1f9ed0385e5ae3693c-2"></a><span class="n">add</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
</pre>
<pre class="code python doctest">&gt;&gt;&gt; 4
</pre>
<p>Nic nadzwyczajnego, ale Å¼eby tradycji staÅ‚o siÄ™ zadoÅ›Ä‡, kilka sÅ‚Ã³w wyjaÅ›nienia jak to dziaÅ‚a:</p>
<ol class="arabic simple">
<li>
<p>Tworzymy wyraÅ¼enie Lambda, ktÃ³re przyjmuje dwie zmienne: <code>a</code> i <code>b</code> oraz wykonuje operacjÄ™ dodawania na tych zmiennych.</p>
</li>
<li>
<p>WyraÅ¼enie to przypisujemy do zmiennej <code>add</code>. W tym momencie zmienna <code>add</code> staje siÄ™ funkcjÄ…, ktÃ³rej ciaÅ‚em jest wyraÅ¼enie Lambda (opisywaÅ‚em ten mechanizm we wpisie dotyczÄ…cym <a class="reference external" href="../20200109/dekoratory-w-pythonie/">dekoratorÃ³w</a>, gdzie tÅ‚umaczyÅ‚em, Å¼e <a class="reference external" href="../20200109/dekoratory-w-pythonie/#funkcja-jest-obiektem">funkcja jest obiektem</a>).</p>
</li>
<li>
<p>WywoÅ‚ujemy tak stworzonÄ… funkcjÄ™ z 2 parametrami. W wyniku wywoÅ‚ania otrzymujemy wynik dodawania.</p>
</li>
</ol>
<p>Odpowiednikiem takiego wyraÅ¼enia bÄ™dzie poniÅ¼szy kod:</p>
<pre class="code python"><a id="rest_code_8c7309a7c01142078e7a9e35a7d81297-1" name="rest_code_8c7309a7c01142078e7a9e35a7d81297-1"></a><span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
<a id="rest_code_8c7309a7c01142078e7a9e35a7d81297-2" name="rest_code_8c7309a7c01142078e7a9e35a7d81297-2"></a>    <span class="k">return</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span>
<a id="rest_code_8c7309a7c01142078e7a9e35a7d81297-3" name="rest_code_8c7309a7c01142078e7a9e35a7d81297-3"></a>
<a id="rest_code_8c7309a7c01142078e7a9e35a7d81297-4" name="rest_code_8c7309a7c01142078e7a9e35a7d81297-4"></a><span class="n">add</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
</pre>
<pre class="code python doctest">&gt;&gt;&gt; 4
</pre>
<p>Zysk niby niewielki, ale zawsze coÅ›. A co, gdybyÅ›my chcieli osiÄ…gnÄ…Ä‡ coÅ› ciekawszego? Zobaczmy co siÄ™ stanie, jak tradycyjna metoda, w wyniku bÄ™dzie zwracaÅ‚a wyraÅ¼enie lambda:</p>
<pre class="code python"><a id="rest_code_181c7e9661bf425fa88dd83f492cfd12-1" name="rest_code_181c7e9661bf425fa88dd83f492cfd12-1"></a><span class="k">def</span> <span class="nf">multiplier</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
<a id="rest_code_181c7e9661bf425fa88dd83f492cfd12-2" name="rest_code_181c7e9661bf425fa88dd83f492cfd12-2"></a>    <span class="k">return</span> <span class="k">lambda</span> <span class="n">a</span><span class="p">:</span> <span class="n">a</span> <span class="o">*</span> <span class="n">n</span>
<a id="rest_code_181c7e9661bf425fa88dd83f492cfd12-3" name="rest_code_181c7e9661bf425fa88dd83f492cfd12-3"></a>
<a id="rest_code_181c7e9661bf425fa88dd83f492cfd12-4" name="rest_code_181c7e9661bf425fa88dd83f492cfd12-4"></a><span class="n">multiplier_1k</span> <span class="o">=</span> <span class="n">multiplier</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span>
<a id="rest_code_181c7e9661bf425fa88dd83f492cfd12-5" name="rest_code_181c7e9661bf425fa88dd83f492cfd12-5"></a>
<a id="rest_code_181c7e9661bf425fa88dd83f492cfd12-6" name="rest_code_181c7e9661bf425fa88dd83f492cfd12-6"></a><span class="n">multiplier_1k</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre>
<pre class="code python doctest">&gt;&gt;&gt; 3000
</pre>
<p>Zaczyna siÄ™ robiÄ‡ ciekawiej. ZauwaÅ¼, Å¼e w ten sposÃ³b moglibyÅ›my bardzo szybko zdefiniowaÄ‡ inne metody np. <code>multiplier_10k = multiplier(10000)</code>, czy teÅ¼ <code>doubler = multiplier(2)</code>. Zaczynasz rozumieÄ‡ z jak potÄ™Å¼nym narzÄ™dziem mamy do czynienia?</p>
<p>Wszystko super, ale jak z tego skorzystaÄ‡ w naszym frameworku?</p>
</div>
<div class="section" id="lambda-po-raz-pierwszy">
<h3>Lambda po raz pierwszy<a class="headerlink" href="#lambda-po-raz-pierwszy" title="Permalink to this heading">Â¶</a></h3>
<p>Skoro juÅ¼ wiemy, Å¼e przy uÅ¼yciu wyraÅ¼enia lambda, moÅ¼na zastÄ…piÄ‡ definicjÄ™ jakiejÅ› meto, to sprÃ³bujmy to zaimplementowaÄ‡ w naszym kodzie. Jak? Zerknij poniÅ¼ej:</p>
<pre class="code python"><a id="rest_code_7d9720e872584ce5854c6125981ff21b-1" name="rest_code_7d9720e872584ce5854c6125981ff21b-1"></a><span class="kn">import</span> <span class="nn">unittest</span><span class="o">,</span> <span class="nn">xmlrunner</span><span class="o">,</span> <span class="nn">json</span><span class="o">,</span> <span class="nn">requests</span>
<a id="rest_code_7d9720e872584ce5854c6125981ff21b-2" name="rest_code_7d9720e872584ce5854c6125981ff21b-2"></a>
<a id="rest_code_7d9720e872584ce5854c6125981ff21b-3" name="rest_code_7d9720e872584ce5854c6125981ff21b-3"></a><span class="k">def</span> <span class="nf">add_test</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
<a id="rest_code_7d9720e872584ce5854c6125981ff21b-4" name="rest_code_7d9720e872584ce5854c6125981ff21b-4"></a>    <span class="nb">setattr</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="k">lambda</span> <span class="bp">self</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">requests</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="o">**</span><span class="n">data</span><span class="p">[</span><span class="s1">'request'</span><span class="p">])</span><span class="o">.</span><span class="n">status_code</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="s1">'assert'</span><span class="p">][</span><span class="s1">'statusCode'</span><span class="p">]))</span>
<a id="rest_code_7d9720e872584ce5854c6125981ff21b-5" name="rest_code_7d9720e872584ce5854c6125981ff21b-5"></a>
<a id="rest_code_7d9720e872584ce5854c6125981ff21b-6" name="rest_code_7d9720e872584ce5854c6125981ff21b-6"></a><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">'tests.json'</span><span class="p">,</span> <span class="s1">'r'</span><span class="p">)</span> <span class="k">as</span> <span class="n">json_file</span><span class="p">:</span>
<a id="rest_code_7d9720e872584ce5854c6125981ff21b-7" name="rest_code_7d9720e872584ce5854c6125981ff21b-7"></a>    <span class="k">class</span> <span class="nc">Tests</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span> <span class="k">pass</span>
<a id="rest_code_7d9720e872584ce5854c6125981ff21b-8" name="rest_code_7d9720e872584ce5854c6125981ff21b-8"></a>    <span class="k">for</span> <span class="n">test_name</span><span class="p">,</span> <span class="n">test_data</span> <span class="ow">in</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">json_file</span><span class="p">)</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="rest_code_7d9720e872584ce5854c6125981ff21b-9" name="rest_code_7d9720e872584ce5854c6125981ff21b-9"></a>        <span class="n">add_test</span><span class="p">(</span><span class="n">Tests</span><span class="p">,</span> <span class="n">test_name</span><span class="p">,</span> <span class="n">test_data</span><span class="p">)</span>
<a id="rest_code_7d9720e872584ce5854c6125981ff21b-10" name="rest_code_7d9720e872584ce5854c6125981ff21b-10"></a>
<a id="rest_code_7d9720e872584ce5854c6125981ff21b-11" name="rest_code_7d9720e872584ce5854c6125981ff21b-11"></a><span class="n">unittest</span><span class="o">.</span><span class="n">main</span><span class="p">(</span><span class="n">testRunner</span><span class="o">=</span><span class="n">xmlrunner</span><span class="o">.</span><span class="n">XMLTestRunner</span><span class="p">())</span>
</pre>
<p>MyÅ›lÄ™, Å¼e zmiany nie wymagajÄ… wiÄ™kszego komentarza, bo jedyne co tutaj zrobiliÅ›my to zastÄ…piliÅ›my definicjÄ™ oraz wywoÅ‚anie metody <code>abstract_test</code> wyraÅ¼eniem lambda. W wyniku, odchudziliÅ›my nasz kod do 11 linii kodu. Jest nieÅºle, ale moÅ¼e da siÄ™ lepiej?</p>
</div>
<div class="section" id="lambda-po-raz-drugi">
<h3>Lambda po raz drugi<a class="headerlink" href="#lambda-po-raz-drugi" title="Permalink to this heading">Â¶</a></h3>
<p>Skoro udaÅ‚o nam siÄ™ pozbyÄ‡ definiowania jednej metody, to moÅ¼e uda nam siÄ™ wyrzuciÄ‡ jeszcze jednÄ…?</p>
<pre class="code python"><a id="rest_code_df7d0168289645df8a776fcec12af6af-1" name="rest_code_df7d0168289645df8a776fcec12af6af-1"></a><span class="kn">import</span> <span class="nn">unittest</span><span class="o">,</span> <span class="nn">xmlrunner</span><span class="o">,</span> <span class="nn">json</span><span class="o">,</span> <span class="nn">requests</span>
<a id="rest_code_df7d0168289645df8a776fcec12af6af-2" name="rest_code_df7d0168289645df8a776fcec12af6af-2"></a>
<a id="rest_code_df7d0168289645df8a776fcec12af6af-3" name="rest_code_df7d0168289645df8a776fcec12af6af-3"></a><span class="n">add_test</span> <span class="o">=</span> <span class="k">lambda</span> <span class="bp">cls</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">setattr</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="k">lambda</span> <span class="bp">self</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">requests</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="o">**</span><span class="n">data</span><span class="p">[</span><span class="s1">'request'</span><span class="p">])</span><span class="o">.</span><span class="n">status_code</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="s1">'assert'</span><span class="p">][</span><span class="s1">'statusCode'</span><span class="p">]))</span>
<a id="rest_code_df7d0168289645df8a776fcec12af6af-4" name="rest_code_df7d0168289645df8a776fcec12af6af-4"></a>
<a id="rest_code_df7d0168289645df8a776fcec12af6af-5" name="rest_code_df7d0168289645df8a776fcec12af6af-5"></a><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">'tests.json'</span><span class="p">,</span> <span class="s1">'r'</span><span class="p">)</span> <span class="k">as</span> <span class="n">json_file</span><span class="p">:</span>
<a id="rest_code_df7d0168289645df8a776fcec12af6af-6" name="rest_code_df7d0168289645df8a776fcec12af6af-6"></a>    <span class="k">class</span> <span class="nc">Tests</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span> <span class="k">pass</span>
<a id="rest_code_df7d0168289645df8a776fcec12af6af-7" name="rest_code_df7d0168289645df8a776fcec12af6af-7"></a>    <span class="k">for</span> <span class="n">test_name</span><span class="p">,</span> <span class="n">test_data</span> <span class="ow">in</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">json_file</span><span class="p">)</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="rest_code_df7d0168289645df8a776fcec12af6af-8" name="rest_code_df7d0168289645df8a776fcec12af6af-8"></a>        <span class="n">add_test</span><span class="p">(</span><span class="n">Tests</span><span class="p">,</span> <span class="n">test_name</span><span class="p">,</span> <span class="n">test_data</span><span class="p">)</span>
<a id="rest_code_df7d0168289645df8a776fcec12af6af-9" name="rest_code_df7d0168289645df8a776fcec12af6af-9"></a>
<a id="rest_code_df7d0168289645df8a776fcec12af6af-10" name="rest_code_df7d0168289645df8a776fcec12af6af-10"></a><span class="n">unittest</span><span class="o">.</span><span class="n">main</span><span class="p">(</span><span class="n">testRunner</span><span class="o">=</span><span class="n">xmlrunner</span><span class="o">.</span><span class="n">XMLTestRunner</span><span class="p">())</span>
</pre>
<p>ZauwaÅ¼, Å¼e dalej podÄ…Å¼amy utartym schematem. Wykonajmy jeszcze jeden drobny zabieg, a wiÄ™c przenieÅ›my przypisanie Lambdy do zmiennej w inne miejsce:</p>
<pre class="code python"><a id="rest_code_80f18470f02345a2be7e083d42a18788-1" name="rest_code_80f18470f02345a2be7e083d42a18788-1"></a><span class="kn">import</span> <span class="nn">unittest</span><span class="o">,</span> <span class="nn">xmlrunner</span><span class="o">,</span> <span class="nn">json</span><span class="o">,</span> <span class="nn">requests</span>
<a id="rest_code_80f18470f02345a2be7e083d42a18788-2" name="rest_code_80f18470f02345a2be7e083d42a18788-2"></a>
<a id="rest_code_80f18470f02345a2be7e083d42a18788-3" name="rest_code_80f18470f02345a2be7e083d42a18788-3"></a><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">'tests.json'</span><span class="p">,</span> <span class="s1">'r'</span><span class="p">)</span> <span class="k">as</span> <span class="n">json_file</span><span class="p">:</span>
<a id="rest_code_80f18470f02345a2be7e083d42a18788-4" name="rest_code_80f18470f02345a2be7e083d42a18788-4"></a>    <span class="k">class</span> <span class="nc">Tests</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span> <span class="k">pass</span>
<a id="rest_code_80f18470f02345a2be7e083d42a18788-5" name="rest_code_80f18470f02345a2be7e083d42a18788-5"></a>    <span class="n">add_test</span> <span class="o">=</span> <span class="k">lambda</span> <span class="bp">cls</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">setattr</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="k">lambda</span> <span class="bp">self</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">requests</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="o">**</span><span class="n">data</span><span class="p">[</span><span class="s1">'request'</span><span class="p">])</span><span class="o">.</span><span class="n">status_code</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="s1">'assert'</span><span class="p">][</span><span class="s1">'statusCode'</span><span class="p">]))</span>
<a id="rest_code_80f18470f02345a2be7e083d42a18788-6" name="rest_code_80f18470f02345a2be7e083d42a18788-6"></a>    <span class="k">for</span> <span class="n">test_name</span><span class="p">,</span> <span class="n">test_data</span> <span class="ow">in</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">json_file</span><span class="p">)</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="rest_code_80f18470f02345a2be7e083d42a18788-7" name="rest_code_80f18470f02345a2be7e083d42a18788-7"></a>        <span class="n">add_test</span><span class="p">(</span><span class="n">Tests</span><span class="p">,</span> <span class="n">test_name</span><span class="p">,</span> <span class="n">test_data</span><span class="p">)</span>
<a id="rest_code_80f18470f02345a2be7e083d42a18788-8" name="rest_code_80f18470f02345a2be7e083d42a18788-8"></a>
<a id="rest_code_80f18470f02345a2be7e083d42a18788-9" name="rest_code_80f18470f02345a2be7e083d42a18788-9"></a><span class="n">unittest</span><span class="o">.</span><span class="n">main</span><span class="p">(</span><span class="n">testRunner</span><span class="o">=</span><span class="n">xmlrunner</span><span class="o">.</span><span class="n">XMLTestRunner</span><span class="p">())</span>
</pre>
<p>OdchudziliÅ›my juÅ¼ nasz kod do 9 linii przy zachowaniu tej samej funkcjonalnoÅ›ci. Czy to odchudzanie kiedyÅ› siÄ™ skoÅ„czy? Tak, ale jeszcze nie w tym momencie. ZauwaÅ¼, Å¼e sama definicja klasy <code>Tests</code>, metody testowej <code>add_test</code> oraz jej wielokrotne wywoÅ‚anie zajmujÄ… aÅ¼ 4 linijki kodu. MoÅ¼e damy radÄ™ jeszcze coÅ› tutaj pokombinowaÄ‡?</p>
</div>
<div class="section" id="type">
<h3>type<a class="headerlink" href="#type" title="Permalink to this heading">Â¶</a></h3>
<p>Metoda <code>type</code> to jedna z metod wbudowanych Pythona i nie wymaga importu (jest zawsze dostÄ™pna, podobnie jak uÅ¼ywana przez nas metoda <code>setattr</code>). WiÄ™kszoÅ›Ä‡ osÃ³b programujÄ…cych w Pythonie uÅ¼ywa tej metody do sprawdzania typu obiektu. Nie kaÅ¼dy jednak zdaje sobie sprawÄ™, Å¼e <code>type</code> moÅ¼na wykorzystaÄ‡ teÅ¼ w innym celu. <a class="reference external" href="https://docs.python.org/3/library/functions.html?highlight=type#type">type</a> moÅ¼emy rÃ³wnieÅ¼ wykorzystaÄ‡ do dynamicznego tworzenia obiektÃ³w w Pythonie. Jak to dziaÅ‚a? To nic skomplikowanego. W obecnym kodzie mamy nastÄ™pujÄ…cÄ… definicjÄ™ klasy: <code>class Tests(unittest.TestCase): pass</code>. Jest to klasa, dziedziczÄ…ca po <code>unittest.TestCase</code> oraz nie posiadajÄ…ca Å¼adnych zmiennych oraz metod. Przy uÅ¼yciu <code>type</code> powyÅ¼sza definicja wyglÄ…daÅ‚aby tak: <code>Tests = type("Tests", (unittest.TestCase,), {})</code>. Co tu siÄ™ podziaÅ‚o?</p>
<ol class="arabic simple">
<li>
<p>Przypisanie do zmiennej juÅ¼ znasz.</p>
</li>
<li>
<p>Jako pierwszy argument podaliÅ›my nazwÄ™ nowego obiektu.</p>
</li>
<li>
<p>Jako drugi argument podaliÅ›my tuple z obiektami, po jakich dziedziczy nowo tworzony obiekt.</p>
</li>
<li>
<p>Jako trzeci argument podaliÅ›my pusty sÅ‚ownik, poniewaÅ¼ nasza klasa jest 'pusta' (to nie do koÅ„ca prawda, bo dziedziczy, po innym obiekcie, ale nie wnikajmy w to tutaj).</p>
</li>
</ol>
<p>Po podstawieniu do naszego kodu, caÅ‚y framework wyglÄ…daÅ‚by nastÄ™pujÄ…co:</p>
<pre class="code python"><a id="rest_code_6e227757c682443b89e72b24091c81f9-1" name="rest_code_6e227757c682443b89e72b24091c81f9-1"></a><span class="kn">import</span> <span class="nn">unittest</span><span class="o">,</span> <span class="nn">xmlrunner</span><span class="o">,</span> <span class="nn">json</span><span class="o">,</span> <span class="nn">requests</span>
<a id="rest_code_6e227757c682443b89e72b24091c81f9-2" name="rest_code_6e227757c682443b89e72b24091c81f9-2"></a>
<a id="rest_code_6e227757c682443b89e72b24091c81f9-3" name="rest_code_6e227757c682443b89e72b24091c81f9-3"></a><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">'tests.json'</span><span class="p">,</span> <span class="s1">'r'</span><span class="p">)</span> <span class="k">as</span> <span class="n">json_file</span><span class="p">:</span>
<a id="rest_code_6e227757c682443b89e72b24091c81f9-4" name="rest_code_6e227757c682443b89e72b24091c81f9-4"></a>    <span class="n">Tests</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="s2">"Tests"</span><span class="p">,</span> <span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">,),</span> <span class="p">{})</span>
<a id="rest_code_6e227757c682443b89e72b24091c81f9-5" name="rest_code_6e227757c682443b89e72b24091c81f9-5"></a>    <span class="n">add_test</span> <span class="o">=</span> <span class="k">lambda</span> <span class="bp">cls</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">setattr</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="k">lambda</span> <span class="bp">self</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">requests</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="o">**</span><span class="n">data</span><span class="p">[</span><span class="s1">'request'</span><span class="p">])</span><span class="o">.</span><span class="n">status_code</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="s1">'assert'</span><span class="p">][</span><span class="s1">'statusCode'</span><span class="p">]))</span>
<a id="rest_code_6e227757c682443b89e72b24091c81f9-6" name="rest_code_6e227757c682443b89e72b24091c81f9-6"></a>    <span class="k">for</span> <span class="n">test_name</span><span class="p">,</span> <span class="n">test_data</span> <span class="ow">in</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">json_file</span><span class="p">)</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="rest_code_6e227757c682443b89e72b24091c81f9-7" name="rest_code_6e227757c682443b89e72b24091c81f9-7"></a>        <span class="n">add_test</span><span class="p">(</span><span class="n">Tests</span><span class="p">,</span> <span class="n">test_name</span><span class="p">,</span> <span class="n">test_data</span><span class="p">)</span>
<a id="rest_code_6e227757c682443b89e72b24091c81f9-8" name="rest_code_6e227757c682443b89e72b24091c81f9-8"></a>
<a id="rest_code_6e227757c682443b89e72b24091c81f9-9" name="rest_code_6e227757c682443b89e72b24091c81f9-9"></a><span class="n">unittest</span><span class="o">.</span><span class="n">main</span><span class="p">(</span><span class="n">testRunner</span><span class="o">=</span><span class="n">xmlrunner</span><span class="o">.</span><span class="n">XMLTestRunner</span><span class="p">())</span>
</pre>
<p>Na razie zysku brak. CiÄ…gle mamy 9 linii kodu. Jednak dla wprawnego oka, przyzwyczajonego do kodu pisanego w Pythonie, widaÄ‡, Å¼e coÅ› tutaj moÅ¼emy teraz uproÅ›ciÄ‡.</p>
</div>
<div class="section" id="dict-comprehension">
<h3>dict comprehension<a class="headerlink" href="#dict-comprehension" title="Permalink to this heading">Â¶</a></h3>
<p>Zwrot <strong>dict comprehension</strong> nie posiada sensownego tÅ‚umaczenia (dlatego bÄ™dÄ™ uÅ¼ywaÅ‚ go w oryginale). Czym jest <strong>dict comprehension</strong>? Jest to sposÃ³b na uproszczenie zapisu, tworzenia sÅ‚ownika z wykorzystaniem pÄ™tli <code>for</code>, ktÃ³ry opisany jest w <a class="reference external" href="https://www.python.org/dev/peps/pep-0274/">PEP 271</a> (istnieje rÃ³wnieÅ¼ bardzo podobny mechanizm jak <strong>list comprehension</strong>, ktÃ³ry opisany jest w <a class="reference external" href="https://www.python.org/dev/peps/pep-0202/">PEP 202</a>). W skrÃ³cie zapis:</p>
<pre class="code python"><a id="rest_code_0c2a33ea69a244a68f1c62ae7e6e5dc3-1" name="rest_code_0c2a33ea69a244a68f1c62ae7e6e5dc3-1"></a><span class="n">keys</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"a"</span><span class="p">,</span> <span class="s2">"b"</span><span class="p">,</span> <span class="s2">"c"</span><span class="p">,</span> <span class="s2">"d"</span><span class="p">]</span>
<a id="rest_code_0c2a33ea69a244a68f1c62ae7e6e5dc3-2" name="rest_code_0c2a33ea69a244a68f1c62ae7e6e5dc3-2"></a><span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>
<a id="rest_code_0c2a33ea69a244a68f1c62ae7e6e5dc3-3" name="rest_code_0c2a33ea69a244a68f1c62ae7e6e5dc3-3"></a>
<a id="rest_code_0c2a33ea69a244a68f1c62ae7e6e5dc3-4" name="rest_code_0c2a33ea69a244a68f1c62ae7e6e5dc3-4"></a><span class="n">new_dict</span> <span class="o">=</span> <span class="p">{}</span>
<a id="rest_code_0c2a33ea69a244a68f1c62ae7e6e5dc3-5" name="rest_code_0c2a33ea69a244a68f1c62ae7e6e5dc3-5"></a>
<a id="rest_code_0c2a33ea69a244a68f1c62ae7e6e5dc3-6" name="rest_code_0c2a33ea69a244a68f1c62ae7e6e5dc3-6"></a><span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">keys</span><span class="p">):</span>
<a id="rest_code_0c2a33ea69a244a68f1c62ae7e6e5dc3-7" name="rest_code_0c2a33ea69a244a68f1c62ae7e6e5dc3-7"></a>    <span class="n">new_dict</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">values</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
<a id="rest_code_0c2a33ea69a244a68f1c62ae7e6e5dc3-8" name="rest_code_0c2a33ea69a244a68f1c62ae7e6e5dc3-8"></a>
<a id="rest_code_0c2a33ea69a244a68f1c62ae7e6e5dc3-9" name="rest_code_0c2a33ea69a244a68f1c62ae7e6e5dc3-9"></a><span class="n">new_dict</span>
</pre>
<pre class="code python doctest">&gt;&gt;&gt; {'a': 10, 'b': 20, 'c': 30, 'd': 40}
</pre>
<p>moÅ¼emy zastÄ…piÄ‡ poprzez zapis:</p>
<pre class="code python"><a id="rest_code_52f0b96123954e748135aff90d714500-1" name="rest_code_52f0b96123954e748135aff90d714500-1"></a><span class="n">keys</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"a"</span><span class="p">,</span> <span class="s2">"b"</span><span class="p">,</span> <span class="s2">"c"</span><span class="p">,</span> <span class="s2">"d"</span><span class="p">]</span>
<a id="rest_code_52f0b96123954e748135aff90d714500-2" name="rest_code_52f0b96123954e748135aff90d714500-2"></a><span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>
<a id="rest_code_52f0b96123954e748135aff90d714500-3" name="rest_code_52f0b96123954e748135aff90d714500-3"></a>
<a id="rest_code_52f0b96123954e748135aff90d714500-4" name="rest_code_52f0b96123954e748135aff90d714500-4"></a><span class="n">new_dict</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">values</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">keys</span><span class="p">)}</span>
<a id="rest_code_52f0b96123954e748135aff90d714500-5" name="rest_code_52f0b96123954e748135aff90d714500-5"></a>
<a id="rest_code_52f0b96123954e748135aff90d714500-6" name="rest_code_52f0b96123954e748135aff90d714500-6"></a><span class="n">new_dict</span>
</pre>
<pre class="code python doctest">&gt;&gt;&gt; {'a': 10, 'b': 20, 'c': 30, 'd': 40}
</pre>
<p>OczywiÅ›cie taka konstrukcja moÅ¼e byÄ‡ wykorzystywana teÅ¼ w poÅ‚Ä…czeniu z warunkami itp. Ale jak to moÅ¼e pomÃ³c w odchudzeniu naszego kodu? Trzymaj siÄ™ krzesÅ‚a.</p>
</div>
<div class="section" id="najmniejszy-framework">
<h3>Najmniejszy framework<a class="headerlink" href="#najmniejszy-framework" title="Permalink to this heading">Â¶</a></h3>
<p>PoskÅ‚adajmy wiÄ™c to wszystko w caÅ‚oÅ›Ä‡:</p>
<pre class="code python"><a id="rest_code_dab14a8f24e44490a808d1d3597cc4b8-1" name="rest_code_dab14a8f24e44490a808d1d3597cc4b8-1"></a><span class="kn">import</span> <span class="nn">unittest</span><span class="o">,</span> <span class="nn">xmlrunner</span><span class="o">,</span> <span class="nn">json</span><span class="o">,</span> <span class="nn">requests</span>
<a id="rest_code_dab14a8f24e44490a808d1d3597cc4b8-2" name="rest_code_dab14a8f24e44490a808d1d3597cc4b8-2"></a>
<a id="rest_code_dab14a8f24e44490a808d1d3597cc4b8-3" name="rest_code_dab14a8f24e44490a808d1d3597cc4b8-3"></a><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">'tests.json'</span><span class="p">,</span> <span class="s1">'r'</span><span class="p">)</span> <span class="k">as</span> <span class="n">json_file</span><span class="p">:</span>
<a id="rest_code_dab14a8f24e44490a808d1d3597cc4b8-4" name="rest_code_dab14a8f24e44490a808d1d3597cc4b8-4"></a>    <span class="n">tests_dict</span> <span class="o">=</span> <span class="p">{</span><span class="n">name</span><span class="p">:</span> <span class="p">(</span><span class="k">lambda</span> <span class="n">data</span><span class="p">:</span> <span class="k">lambda</span> <span class="bp">self</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span>
<a id="rest_code_dab14a8f24e44490a808d1d3597cc4b8-5" name="rest_code_dab14a8f24e44490a808d1d3597cc4b8-5"></a>        <span class="n">requests</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="o">**</span><span class="n">data</span><span class="p">[</span><span class="s1">'request'</span><span class="p">])</span><span class="o">.</span><span class="n">status_code</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="s1">'assert'</span><span class="p">][</span><span class="s1">'statusCode'</span><span class="p">]))(</span><span class="n">data</span><span class="p">)</span>
<a id="rest_code_dab14a8f24e44490a808d1d3597cc4b8-6" name="rest_code_dab14a8f24e44490a808d1d3597cc4b8-6"></a>                  <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">json_file</span><span class="p">)</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
<a id="rest_code_dab14a8f24e44490a808d1d3597cc4b8-7" name="rest_code_dab14a8f24e44490a808d1d3597cc4b8-7"></a>    <span class="p">}</span>
<a id="rest_code_dab14a8f24e44490a808d1d3597cc4b8-8" name="rest_code_dab14a8f24e44490a808d1d3597cc4b8-8"></a>    <span class="n">Tests</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="s2">"Tests"</span><span class="p">,</span> <span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">,),</span> <span class="n">tests_dict</span><span class="p">)</span>
<a id="rest_code_dab14a8f24e44490a808d1d3597cc4b8-9" name="rest_code_dab14a8f24e44490a808d1d3597cc4b8-9"></a>
<a id="rest_code_dab14a8f24e44490a808d1d3597cc4b8-10" name="rest_code_dab14a8f24e44490a808d1d3597cc4b8-10"></a><span class="n">unittest</span><span class="o">.</span><span class="n">main</span><span class="p">(</span><span class="n">testRunner</span><span class="o">=</span><span class="n">xmlrunner</span><span class="o">.</span><span class="n">XMLTestRunner</span><span class="p">())</span>
</pre>
<p>Jak to dziaÅ‚a? Przy wykorzystaniu <strong>dict comprehension</strong> stworzyliÅ›my sÅ‚ownik <code>tests_dict</code>, ktÃ³ry zawiera wszystkie metody testowe, ktÃ³re wczeÅ›niej tworzone byÅ‚y wewnÄ…trz pÄ™tli <code>for</code>. PominÄ™liÅ›my rÃ³wnieÅ¼ krok dotyczÄ…cy definicji oraz wywoÅ‚ania metody <code>add_test</code>. Nie jest ona w tym momencie konieczna, poniewaÅ¼ przypisujemy metodÄ™ bezpoÅ›rednio do zmiennej, ktÃ³ra jest wartoÅ›ciÄ… sÅ‚ownika, przypisanÄ… do odpowiedniego klucza w tym sÅ‚owniku. Tak zdefiniowany sÅ‚ownik wstawiamy do dynamicznie tworzonej klasy.</p>
<p>PowyÅ¼szy kod zostaÅ‚ przedstawiony w ten sposÃ³b, aby choÄ‡ trochÄ™ zachowaÄ‡ jego czytelnoÅ›Ä‡. JeÅ›li jednak pozbÄ™dziemy siÄ™ niepotrzebnego formatowania oraz przypisania sÅ‚ownika do zmiennej <code>tests_dict</code>, nasz kod bÄ™dzie wyglÄ…daÅ‚ nastÄ™pujÄ…co:</p>
<pre class="code python"><a id="rest_code_6d433a15d75e43e4b76f1eb653050d2a-1" name="rest_code_6d433a15d75e43e4b76f1eb653050d2a-1"></a><span class="kn">import</span> <span class="nn">unittest</span><span class="o">,</span> <span class="nn">xmlrunner</span><span class="o">,</span> <span class="nn">json</span><span class="o">,</span> <span class="nn">requests</span>
<a id="rest_code_6d433a15d75e43e4b76f1eb653050d2a-2" name="rest_code_6d433a15d75e43e4b76f1eb653050d2a-2"></a>
<a id="rest_code_6d433a15d75e43e4b76f1eb653050d2a-3" name="rest_code_6d433a15d75e43e4b76f1eb653050d2a-3"></a><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">'tests.json'</span><span class="p">,</span> <span class="s1">'r'</span><span class="p">)</span> <span class="k">as</span> <span class="n">json_file</span><span class="p">:</span>
<a id="rest_code_6d433a15d75e43e4b76f1eb653050d2a-4" name="rest_code_6d433a15d75e43e4b76f1eb653050d2a-4"></a>    <span class="n">Tests</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="s2">"Tests"</span><span class="p">,</span> <span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">,),</span> <span class="p">{</span><span class="n">name</span><span class="p">:</span> <span class="p">(</span><span class="k">lambda</span> <span class="n">data</span><span class="p">:</span> <span class="k">lambda</span> <span class="bp">self</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">requests</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="o">**</span><span class="n">data</span><span class="p">[</span><span class="s1">'request'</span><span class="p">])</span><span class="o">.</span><span class="n">status_code</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="s1">'assert'</span><span class="p">][</span><span class="s1">'statusCode'</span><span class="p">]))(</span><span class="n">data</span><span class="p">)</span> <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">json_file</span><span class="p">)</span><span class="o">.</span><span class="n">items</span><span class="p">()})</span>
<a id="rest_code_6d433a15d75e43e4b76f1eb653050d2a-5" name="rest_code_6d433a15d75e43e4b76f1eb653050d2a-5"></a>
<a id="rest_code_6d433a15d75e43e4b76f1eb653050d2a-6" name="rest_code_6d433a15d75e43e4b76f1eb653050d2a-6"></a><span class="n">unittest</span><span class="o">.</span><span class="n">main</span><span class="p">(</span><span class="n">testRunner</span><span class="o">=</span><span class="n">xmlrunner</span><span class="o">.</span><span class="n">XMLTestRunner</span><span class="p">())</span>
</pre>
<p>Tak dobrze widzisz, Å¼e nasz framework mieÅ›ci siÄ™ w <strong>6 linijkach kodu</strong> (pomijajÄ…c puste linie, moglibyÅ›my odchudziÄ‡ ten kod do zaledwie 4 linii kodu, co byÅ‚o by juÅ¼ tylko kosmetycznÄ… zmianÄ…). Nie wiem jak dla Ciebie, ale dla mnie to lekki obÅ‚Ä™d.</p>
</div>
</div>
<div class="section" id="wiecej-funkcjonalnosci">
<h2>WiÄ™cej funkcjonalnoÅ›ci<a class="headerlink" href="#wiecej-funkcjonalnosci" title="Permalink to this heading">Â¶</a></h2>
<p>Skoro odchudziliÅ›my kod frameworku do zaledwie 6 linijek kodu, to do pierwotnie zakÅ‚adanych 16 linijek, trochÄ™ nam brakuje. SprÃ³bujmy wykorzystaÄ‡ ten zapas, do stworzenia testÃ³w, ktÃ³re testujÄ… coÅ› wiÄ™cej.</p>
<p>Ale co tak na prawdÄ™ moÅ¼emy dodaÄ‡ do naszego frameworka, aby byÅ‚ bardziej rozbudowany? Do gÅ‚owy przychodzÄ… mi 3 rzeczy:</p>
<ol class="arabic simple">
<li>
<p>Dodanie weryfikacji poprawnoÅ›ci struktury danych jakimi odpowiada testowany endpoint poprzez weryfikacjÄ™ listy kluczy.</p>
</li>
<li>
<p>Dodanie weryfikacji czasu odpowiedzi danego endpointa.</p>
</li>
<li>
<p>Wsparcie dla wielu plikÃ³w json, co da nam moÅ¼liwoÅ›Ä‡ rozbicia testÃ³w do testowania mniejszych funkcjonalnoÅ›ci lub grupowania testÃ³w jako suity testÃ³w.</p>
</li>
</ol>
<p>AbyÅ›my mogli wprowadziÄ‡ powyÅ¼sze rozszerzenia, potrzebujemy delikatnie zmodyfikowaÄ‡ obecny kod poprzez wydzielenie metody z testem z wnÄ™trza sÅ‚ownika. PoniÅ¼szy kod prezentuje jak tego dokonaÄ‡:</p>
<pre class="code python"><a id="rest_code_43c60f00cdde41afb31e178b7099b0d7-1" name="rest_code_43c60f00cdde41afb31e178b7099b0d7-1"></a><span class="kn">import</span> <span class="nn">unittest</span><span class="o">,</span> <span class="nn">xmlrunner</span><span class="o">,</span> <span class="nn">json</span><span class="o">,</span> <span class="nn">requests</span>
<a id="rest_code_43c60f00cdde41afb31e178b7099b0d7-2" name="rest_code_43c60f00cdde41afb31e178b7099b0d7-2"></a>
<a id="rest_code_43c60f00cdde41afb31e178b7099b0d7-3" name="rest_code_43c60f00cdde41afb31e178b7099b0d7-3"></a><span class="k">def</span> <span class="nf">abstract_test</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
<a id="rest_code_43c60f00cdde41afb31e178b7099b0d7-4" name="rest_code_43c60f00cdde41afb31e178b7099b0d7-4"></a>    <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="o">**</span><span class="n">data</span><span class="p">[</span><span class="s1">'request'</span><span class="p">])</span>
<a id="rest_code_43c60f00cdde41afb31e178b7099b0d7-5" name="rest_code_43c60f00cdde41afb31e178b7099b0d7-5"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="s1">'assert'</span><span class="p">][</span><span class="s1">'statusCode'</span><span class="p">])</span>
<a id="rest_code_43c60f00cdde41afb31e178b7099b0d7-6" name="rest_code_43c60f00cdde41afb31e178b7099b0d7-6"></a>
<a id="rest_code_43c60f00cdde41afb31e178b7099b0d7-7" name="rest_code_43c60f00cdde41afb31e178b7099b0d7-7"></a><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">'tests.json'</span><span class="p">,</span> <span class="s1">'r'</span><span class="p">)</span> <span class="k">as</span> <span class="n">json_file</span><span class="p">:</span>
<a id="rest_code_43c60f00cdde41afb31e178b7099b0d7-8" name="rest_code_43c60f00cdde41afb31e178b7099b0d7-8"></a>    <span class="n">test</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">data</span><span class="p">:</span> <span class="k">lambda</span> <span class="bp">self</span><span class="p">:</span> <span class="n">abstract_test</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
<a id="rest_code_43c60f00cdde41afb31e178b7099b0d7-9" name="rest_code_43c60f00cdde41afb31e178b7099b0d7-9"></a>    <span class="n">Tests</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="s2">"Tests"</span><span class="p">,</span> <span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">,),</span> <span class="p">{</span><span class="n">name</span><span class="p">:</span> <span class="n">test</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">json_file</span><span class="p">)</span><span class="o">.</span><span class="n">items</span><span class="p">()})</span>
<a id="rest_code_43c60f00cdde41afb31e178b7099b0d7-10" name="rest_code_43c60f00cdde41afb31e178b7099b0d7-10"></a>
<a id="rest_code_43c60f00cdde41afb31e178b7099b0d7-11" name="rest_code_43c60f00cdde41afb31e178b7099b0d7-11"></a><span class="n">unittest</span><span class="o">.</span><span class="n">main</span><span class="p">(</span><span class="n">testRunner</span><span class="o">=</span><span class="n">xmlrunner</span><span class="o">.</span><span class="n">XMLTestRunner</span><span class="p">())</span>
</pre>
<p>Zmiany, ktÃ³re zostaÅ‚y wprowadzone nie powinny byÄ‡ zaskoczeniem, gdyÅ¼ bardzo podobny kod byÅ‚ w akapicie dotyczÄ…cym wykorzystania <a class="reference external" href="#lambda-po-raz-pierwszy">lambdy</a>.</p>
<p>Skoro mamy juÅ¼ podwaliny do dalszej zabawy, rozszerzmy kod o dodatkowe sprawdzenia.</p>
<div class="section" id="wiecej-testow-w-tescie">
<h3>WiÄ™cej testÃ³w w teÅ›cie<a class="headerlink" href="#wiecej-testow-w-tescie" title="Permalink to this heading">Â¶</a></h3>
<p>PoniewaÅ¼ wiemy juÅ¼ co jeszcze chcemy testowaÄ‡, musimy znaleÅºÄ‡ sposÃ³b na pobranie potrzebnych informacji. Okazuje siÄ™, Å¼e wszystko tak na prawdÄ™ juÅ¼ w naszym kodzie jest, ale jeszcze z tych informacji nie robimy uÅ¼ytku. Te i inne dodatkowe informacje otrzymujemy w <a class="reference external" href="https://requests.readthedocs.io/en/master/api/#requests.Response">odpowiedzi na wysÅ‚ane Å¼Ä…danie</a>. WartoÅ›ci, z ktÃ³rych moÅ¼emy skorzystaÄ‡ w teÅ›cie to:</p>
<ul class="simple">
<li>
<p><code>resposne.json()</code> - zwraca sÅ‚ownik z danymi, ktÃ³rymi odpowiedziaÅ‚ endpoint,</p>
</li>
<li>
<p><code>response.elapsed.total_seconds()</code> - zawiera czas pomiÄ™dzy wysÅ‚aniem Å¼Ä…dania, a otrzymaniem odpowiedzi.</p>
</li>
</ul>
<p>IstniejÄ… rÃ³wnieÅ¼ inne ciekawe wartoÅ›ci, z ktÃ³rych moÅ¼na skorzystaÄ‡, np. <code>response.headers</code>, ale nie zmieÅ›cilibyÅ›my siÄ™ w wymaganej iloÅ›ci kodu oraz musielibyÅ›my przechowywaÄ‡ duÅ¼o wiÄ™cej informacji w pliku <strong>json</strong>.</p>
<p>AbyÅ›my mogli z tych informacji skorzystaÄ‡, musimy doÅ‚oÅ¼yÄ‡ pewne dane do naszego pliku <code>tests.json</code>:</p>
<pre class="code json"><a id="rest_code_ca4933ef797b4a9da98b4c04a03a0688-1" name="rest_code_ca4933ef797b4a9da98b4c04a03a0688-1"></a><span class="p">{</span>
<a id="rest_code_ca4933ef797b4a9da98b4c04a03a0688-2" name="rest_code_ca4933ef797b4a9da98b4c04a03a0688-2"></a>  <span class="nt">"test_get_all_users"</span><span class="p">:</span> <span class="p">{</span>
<a id="rest_code_ca4933ef797b4a9da98b4c04a03a0688-3" name="rest_code_ca4933ef797b4a9da98b4c04a03a0688-3"></a>    <span class="nt">"request"</span><span class="p">:</span> <span class="p">{</span>
<a id="rest_code_ca4933ef797b4a9da98b4c04a03a0688-4" name="rest_code_ca4933ef797b4a9da98b4c04a03a0688-4"></a>      <span class="nt">"method"</span><span class="p">:</span> <span class="s2">"GET"</span><span class="p">,</span>
<a id="rest_code_ca4933ef797b4a9da98b4c04a03a0688-5" name="rest_code_ca4933ef797b4a9da98b4c04a03a0688-5"></a>      <span class="nt">"url"</span><span class="p">:</span> <span class="s2">"https://reqres.in/api/users"</span>
<a id="rest_code_ca4933ef797b4a9da98b4c04a03a0688-6" name="rest_code_ca4933ef797b4a9da98b4c04a03a0688-6"></a>    <span class="p">},</span>
<a id="rest_code_ca4933ef797b4a9da98b4c04a03a0688-7" name="rest_code_ca4933ef797b4a9da98b4c04a03a0688-7"></a>    <span class="nt">"assert"</span><span class="p">:</span> <span class="p">{</span>
<a id="rest_code_ca4933ef797b4a9da98b4c04a03a0688-8" name="rest_code_ca4933ef797b4a9da98b4c04a03a0688-8"></a>      <span class="nt">"statusCode"</span><span class="p">:</span> <span class="mi">200</span><span class="p">,</span>
<a id="rest_code_ca4933ef797b4a9da98b4c04a03a0688-9" name="rest_code_ca4933ef797b4a9da98b4c04a03a0688-9"></a>      <span class="nt">"responseKeys"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"page"</span><span class="p">,</span> <span class="s2">"total"</span><span class="p">,</span> <span class="s2">"per_page"</span><span class="p">,</span> <span class="s2">"total_pages"</span><span class="p">,</span> <span class="s2">"data"</span><span class="p">,</span> <span class="s2">"support"</span><span class="p">],</span>
<a id="rest_code_ca4933ef797b4a9da98b4c04a03a0688-10" name="rest_code_ca4933ef797b4a9da98b4c04a03a0688-10"></a>      <span class="nt">"responseTime"</span><span class="p">:</span> <span class="mf">0.300</span>
<a id="rest_code_ca4933ef797b4a9da98b4c04a03a0688-11" name="rest_code_ca4933ef797b4a9da98b4c04a03a0688-11"></a>    <span class="p">}</span>
<a id="rest_code_ca4933ef797b4a9da98b4c04a03a0688-12" name="rest_code_ca4933ef797b4a9da98b4c04a03a0688-12"></a>  <span class="p">},</span>
<a id="rest_code_ca4933ef797b4a9da98b4c04a03a0688-13" name="rest_code_ca4933ef797b4a9da98b4c04a03a0688-13"></a>  <span class="nt">"test_get_users_id_2"</span><span class="p">:</span> <span class="p">{</span>
<a id="rest_code_ca4933ef797b4a9da98b4c04a03a0688-14" name="rest_code_ca4933ef797b4a9da98b4c04a03a0688-14"></a>    <span class="nt">"request"</span><span class="p">:</span> <span class="p">{</span>
<a id="rest_code_ca4933ef797b4a9da98b4c04a03a0688-15" name="rest_code_ca4933ef797b4a9da98b4c04a03a0688-15"></a>      <span class="nt">"method"</span><span class="p">:</span> <span class="s2">"GET"</span><span class="p">,</span>
<a id="rest_code_ca4933ef797b4a9da98b4c04a03a0688-16" name="rest_code_ca4933ef797b4a9da98b4c04a03a0688-16"></a>      <span class="nt">"url"</span><span class="p">:</span> <span class="s2">"https://reqres.in/api/users/2"</span>
<a id="rest_code_ca4933ef797b4a9da98b4c04a03a0688-17" name="rest_code_ca4933ef797b4a9da98b4c04a03a0688-17"></a>    <span class="p">},</span>
<a id="rest_code_ca4933ef797b4a9da98b4c04a03a0688-18" name="rest_code_ca4933ef797b4a9da98b4c04a03a0688-18"></a>    <span class="nt">"assert"</span><span class="p">:</span> <span class="p">{</span>
<a id="rest_code_ca4933ef797b4a9da98b4c04a03a0688-19" name="rest_code_ca4933ef797b4a9da98b4c04a03a0688-19"></a>      <span class="nt">"statusCode"</span><span class="p">:</span> <span class="mi">200</span><span class="p">,</span>
<a id="rest_code_ca4933ef797b4a9da98b4c04a03a0688-20" name="rest_code_ca4933ef797b4a9da98b4c04a03a0688-20"></a>      <span class="nt">"responseKeys"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"data"</span><span class="p">,</span> <span class="s2">"support"</span><span class="p">],</span>
<a id="rest_code_ca4933ef797b4a9da98b4c04a03a0688-21" name="rest_code_ca4933ef797b4a9da98b4c04a03a0688-21"></a>      <span class="nt">"responseTime"</span><span class="p">:</span> <span class="mf">0.300</span>
<a id="rest_code_ca4933ef797b4a9da98b4c04a03a0688-22" name="rest_code_ca4933ef797b4a9da98b4c04a03a0688-22"></a>    <span class="p">}</span>
<a id="rest_code_ca4933ef797b4a9da98b4c04a03a0688-23" name="rest_code_ca4933ef797b4a9da98b4c04a03a0688-23"></a>  <span class="p">},</span>
<a id="rest_code_ca4933ef797b4a9da98b4c04a03a0688-24" name="rest_code_ca4933ef797b4a9da98b4c04a03a0688-24"></a>  <span class="nt">"test_get_non_existing_user"</span><span class="p">:</span> <span class="p">{</span>
<a id="rest_code_ca4933ef797b4a9da98b4c04a03a0688-25" name="rest_code_ca4933ef797b4a9da98b4c04a03a0688-25"></a>    <span class="nt">"request"</span><span class="p">:</span> <span class="p">{</span>
<a id="rest_code_ca4933ef797b4a9da98b4c04a03a0688-26" name="rest_code_ca4933ef797b4a9da98b4c04a03a0688-26"></a>      <span class="nt">"method"</span><span class="p">:</span> <span class="s2">"GET"</span><span class="p">,</span>
<a id="rest_code_ca4933ef797b4a9da98b4c04a03a0688-27" name="rest_code_ca4933ef797b4a9da98b4c04a03a0688-27"></a>      <span class="nt">"url"</span><span class="p">:</span> <span class="s2">"https://reqres.in/api/users/23"</span>
<a id="rest_code_ca4933ef797b4a9da98b4c04a03a0688-28" name="rest_code_ca4933ef797b4a9da98b4c04a03a0688-28"></a>    <span class="p">},</span>
<a id="rest_code_ca4933ef797b4a9da98b4c04a03a0688-29" name="rest_code_ca4933ef797b4a9da98b4c04a03a0688-29"></a>    <span class="nt">"assert"</span><span class="p">:</span> <span class="p">{</span>
<a id="rest_code_ca4933ef797b4a9da98b4c04a03a0688-30" name="rest_code_ca4933ef797b4a9da98b4c04a03a0688-30"></a>      <span class="nt">"statusCode"</span><span class="p">:</span> <span class="mi">404</span><span class="p">,</span>
<a id="rest_code_ca4933ef797b4a9da98b4c04a03a0688-31" name="rest_code_ca4933ef797b4a9da98b4c04a03a0688-31"></a>      <span class="nt">"responseKeys"</span><span class="p">:</span> <span class="p">[],</span>
<a id="rest_code_ca4933ef797b4a9da98b4c04a03a0688-32" name="rest_code_ca4933ef797b4a9da98b4c04a03a0688-32"></a>      <span class="nt">"responseTime"</span><span class="p">:</span> <span class="mf">0.300</span>
<a id="rest_code_ca4933ef797b4a9da98b4c04a03a0688-33" name="rest_code_ca4933ef797b4a9da98b4c04a03a0688-33"></a>    <span class="p">}</span>
<a id="rest_code_ca4933ef797b4a9da98b4c04a03a0688-34" name="rest_code_ca4933ef797b4a9da98b4c04a03a0688-34"></a>  <span class="p">},</span>
<a id="rest_code_ca4933ef797b4a9da98b4c04a03a0688-35" name="rest_code_ca4933ef797b4a9da98b4c04a03a0688-35"></a>  <span class="nt">"test_create_new_user"</span><span class="p">:</span> <span class="p">{</span>
<a id="rest_code_ca4933ef797b4a9da98b4c04a03a0688-36" name="rest_code_ca4933ef797b4a9da98b4c04a03a0688-36"></a>    <span class="nt">"request"</span><span class="p">:</span> <span class="p">{</span>
<a id="rest_code_ca4933ef797b4a9da98b4c04a03a0688-37" name="rest_code_ca4933ef797b4a9da98b4c04a03a0688-37"></a>      <span class="nt">"method"</span><span class="p">:</span> <span class="s2">"POST"</span><span class="p">,</span>
<a id="rest_code_ca4933ef797b4a9da98b4c04a03a0688-38" name="rest_code_ca4933ef797b4a9da98b4c04a03a0688-38"></a>      <span class="nt">"url"</span><span class="p">:</span> <span class="s2">"https://reqres.in/api/users"</span><span class="p">,</span>
<a id="rest_code_ca4933ef797b4a9da98b4c04a03a0688-39" name="rest_code_ca4933ef797b4a9da98b4c04a03a0688-39"></a>      <span class="nt">"json"</span><span class="p">:</span> <span class="p">{</span>
<a id="rest_code_ca4933ef797b4a9da98b4c04a03a0688-40" name="rest_code_ca4933ef797b4a9da98b4c04a03a0688-40"></a>        <span class="nt">"name"</span><span class="p">:</span> <span class="s2">"testerembyc"</span><span class="p">,</span>
<a id="rest_code_ca4933ef797b4a9da98b4c04a03a0688-41" name="rest_code_ca4933ef797b4a9da98b4c04a03a0688-41"></a>        <span class="nt">"jon"</span><span class="p">:</span> <span class="s2">"tester"</span>
<a id="rest_code_ca4933ef797b4a9da98b4c04a03a0688-42" name="rest_code_ca4933ef797b4a9da98b4c04a03a0688-42"></a>      <span class="p">}</span>
<a id="rest_code_ca4933ef797b4a9da98b4c04a03a0688-43" name="rest_code_ca4933ef797b4a9da98b4c04a03a0688-43"></a>    <span class="p">},</span>
<a id="rest_code_ca4933ef797b4a9da98b4c04a03a0688-44" name="rest_code_ca4933ef797b4a9da98b4c04a03a0688-44"></a>    <span class="nt">"assert"</span><span class="p">:</span> <span class="p">{</span>
<a id="rest_code_ca4933ef797b4a9da98b4c04a03a0688-45" name="rest_code_ca4933ef797b4a9da98b4c04a03a0688-45"></a>      <span class="nt">"statusCode"</span><span class="p">:</span> <span class="mi">201</span><span class="p">,</span>
<a id="rest_code_ca4933ef797b4a9da98b4c04a03a0688-46" name="rest_code_ca4933ef797b4a9da98b4c04a03a0688-46"></a>      <span class="nt">"responseKeys"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"name"</span><span class="p">,</span> <span class="s2">"jon"</span><span class="p">,</span> <span class="s2">"id"</span><span class="p">,</span> <span class="s2">"createdAt"</span><span class="p">],</span>
<a id="rest_code_ca4933ef797b4a9da98b4c04a03a0688-47" name="rest_code_ca4933ef797b4a9da98b4c04a03a0688-47"></a>      <span class="nt">"responseTime"</span><span class="p">:</span> <span class="mf">0.300</span>
<a id="rest_code_ca4933ef797b4a9da98b4c04a03a0688-48" name="rest_code_ca4933ef797b4a9da98b4c04a03a0688-48"></a>    <span class="p">}</span>
<a id="rest_code_ca4933ef797b4a9da98b4c04a03a0688-49" name="rest_code_ca4933ef797b4a9da98b4c04a03a0688-49"></a>  <span class="p">}</span>
<a id="rest_code_ca4933ef797b4a9da98b4c04a03a0688-50" name="rest_code_ca4933ef797b4a9da98b4c04a03a0688-50"></a><span class="p">}</span>
</pre>
<p>PrzerÃ³bmy teraz nasz kod, tak aby skorzystaÅ‚ z tych danych:</p>
<pre class="code python"><a id="rest_code_ca82db2671b941d4b4b109139003ada6-1" name="rest_code_ca82db2671b941d4b4b109139003ada6-1"></a><span class="kn">import</span> <span class="nn">unittest</span><span class="o">,</span> <span class="nn">xmlrunner</span><span class="o">,</span> <span class="nn">json</span><span class="o">,</span> <span class="nn">requests</span><span class="o">,</span> <span class="nn">glob</span>
<a id="rest_code_ca82db2671b941d4b4b109139003ada6-2" name="rest_code_ca82db2671b941d4b4b109139003ada6-2"></a>
<a id="rest_code_ca82db2671b941d4b4b109139003ada6-3" name="rest_code_ca82db2671b941d4b4b109139003ada6-3"></a><span class="k">def</span> <span class="nf">abstract_test</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
<a id="rest_code_ca82db2671b941d4b4b109139003ada6-4" name="rest_code_ca82db2671b941d4b4b109139003ada6-4"></a>    <span class="n">response</span><span class="p">:</span> <span class="n">requests</span><span class="o">.</span><span class="n">Response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="o">**</span><span class="n">data</span><span class="p">[</span><span class="s1">'request'</span><span class="p">])</span>
<a id="rest_code_ca82db2671b941d4b4b109139003ada6-5" name="rest_code_ca82db2671b941d4b4b109139003ada6-5"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="s1">'assert'</span><span class="p">][</span><span class="s1">'statusCode'</span><span class="p">])</span>
<a id="rest_code_ca82db2671b941d4b4b109139003ada6-6" name="rest_code_ca82db2671b941d4b4b109139003ada6-6"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">assertSetEqual</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span><span class="o">.</span><span class="n">keys</span><span class="p">()),</span> <span class="nb">set</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">'assert'</span><span class="p">][</span><span class="s1">'responseKeys'</span><span class="p">]))</span>
<a id="rest_code_ca82db2671b941d4b4b109139003ada6-7" name="rest_code_ca82db2671b941d4b4b109139003ada6-7"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">assertLessEqual</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">elapsed</span><span class="o">.</span><span class="n">total_seconds</span><span class="p">(),</span> <span class="n">data</span><span class="p">[</span><span class="s1">'assert'</span><span class="p">][</span><span class="s1">'responseTime'</span><span class="p">])</span>
<a id="rest_code_ca82db2671b941d4b4b109139003ada6-8" name="rest_code_ca82db2671b941d4b4b109139003ada6-8"></a>
<a id="rest_code_ca82db2671b941d4b4b109139003ada6-9" name="rest_code_ca82db2671b941d4b4b109139003ada6-9"></a><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">'tests.json'</span><span class="p">,</span> <span class="s1">'r'</span><span class="p">)</span> <span class="k">as</span> <span class="n">json_file</span><span class="p">:</span>
<a id="rest_code_ca82db2671b941d4b4b109139003ada6-10" name="rest_code_ca82db2671b941d4b4b109139003ada6-10"></a>    <span class="n">test</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">data</span><span class="p">:</span> <span class="k">lambda</span> <span class="bp">self</span><span class="p">:</span> <span class="n">abstract_test</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
<a id="rest_code_ca82db2671b941d4b4b109139003ada6-11" name="rest_code_ca82db2671b941d4b4b109139003ada6-11"></a>    <span class="n">Tests</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="s2">"Tests"</span><span class="p">,</span> <span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">,),</span> <span class="p">{</span><span class="n">name</span><span class="p">:</span> <span class="n">test</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">json_file</span><span class="p">)</span><span class="o">.</span><span class="n">items</span><span class="p">()})</span>
<a id="rest_code_ca82db2671b941d4b4b109139003ada6-12" name="rest_code_ca82db2671b941d4b4b109139003ada6-12"></a>
<a id="rest_code_ca82db2671b941d4b4b109139003ada6-13" name="rest_code_ca82db2671b941d4b4b109139003ada6-13"></a><span class="n">unittest</span><span class="o">.</span><span class="n">main</span><span class="p">(</span><span class="n">testRunner</span><span class="o">=</span><span class="n">xmlrunner</span><span class="o">.</span><span class="n">XMLTestRunner</span><span class="p">())</span>
</pre>
<p>Sprawdzenie czasu odpowiedzi nie powinno byÄ‡ zaskoczeniem. Natomiast jeÅ›li chodzi o porÃ³wnanie struktury danych odpowiedzi wymaga drobnej ekwilibrystyki na danych:</p>
<ul class="simple">
<li>
<p>wyciÄ…gamy same klucze z odpowiedzi,</p>
</li>
<li>
<p>nastÄ™pnie listÄ™ zamieniamy na <code>set</code>,</p>
</li>
<li>
<p>listÄ™ oczekiwanych kluczy rÃ³wnieÅ¼ zamieniamy na <code>set</code>.</p>
</li>
</ul>
<p>Zapytasz siÄ™ po co to wszystko? PowÃ³d jest prosty, tzn. lista jest zbiorem uporzÄ…dkowanych wartoÅ›ci i aby 2 listy byÅ‚y uznane za identyczne, obie listy poza zawieraniem tych samych wartoÅ›ci, muszÄ… mieÄ‡ jeszcze te wartoÅ›ci uÅ‚oÅ¼one w takiej samej kolejnoÅ›ci. <code>set</code> natomiast w tym wzglÄ™dzie jest mniej restrykcyjny i wymaga tylko posiadania takich samych wartoÅ›ci, nie przejmujÄ…c siÄ™ zupeÅ‚nie ich kolejnoÅ›ciÄ…. DziÄ™ki temu, zdecydowanie uÅ‚atwiamy sobie wprowadzanie danych testowych oraz eliminujemy faÅ‚szywe bÅ‚Ä™dy spowodowane przez innÄ… kolejnoÅ›Ä‡ zwracanych przez endpoint wartoÅ›ci.</p>
<p>W tym momencie mamy 13 linii kodu, wiÄ™c teoretycznie moglibyÅ›my coÅ› tutaj jeszcze dorzuciÄ‡, ale musimy pamiÄ™taj jeszcze o kwestii zwiÄ…zanej z obsÅ‚ugÄ… dodatkowy plikÃ³w <strong>json</strong>. Zanim to zrobimy, musimy wprowadziÄ‡ dodatkowÄ… bibliotekÄ™ oraz omÃ³wiÄ‡ jednÄ… dodatkowÄ… metodÄ™, ktÃ³rych uÅ¼yjemy do tego zadania.</p>
</div>
<div class="section" id="glob">
<h3>glob<a class="headerlink" href="#glob" title="Permalink to this heading">Â¶</a></h3>
<p>Biblioteka <a class="reference external" href="https://docs.python.org/3/library/glob.html">glob</a> w duÅ¼ym uproszczeniu sÅ‚uÅ¼y do wyszukiwania plikÃ³w i katalogÃ³w. Na nasze potrzeby wykorzystamy tylko jednÄ… metodÄ™. a dokÅ‚adniej <a class="reference external" href="https://docs.python.org/3/library/glob.html">glob.iglob</a>. Wykorzystamy ja do wyszukiwania plikÃ³w <strong>json</strong>.</p>
</div>
<div class="section" id="globals">
<h3>globals()<a class="headerlink" href="#globals" title="Permalink to this heading">Â¶</a></h3>
<p><a class="reference external" href="https://docs.python.org/3/library/functions.html#globals">globals()</a> to kolejna z wbudowanych metod Pythona, ktÃ³ra przechowuje zmienne globalne dla danego moduÅ‚u. Na tym etapie, gdybyÅ›my w naszym kodzie wyÅ›wietli zawartoÅ›Ä‡, ktÃ³rÄ… zwraca <code>globals()</code>, zauwaÅ¼ylibyÅ›my m.in. coÅ› takiego:</p>
<pre class="code python doctest">&gt;&gt;&gt; 'Tests': &lt;class '__main__.Tests'&gt;
</pre>
<p>Jest to zmienna, w ktÃ³rej przechowywana jest klasa z testami z pojedynczego pliku <strong>json</strong>. Po co nam to wiedzieÄ‡? Zapraszam dalej.</p>
</div>
<div class="section" id="obsluga-wielu-plikow-json">
<h3>ObsÅ‚uga wielu plikÃ³w json<a class="headerlink" href="#obsluga-wielu-plikow-json" title="Permalink to this heading">Â¶</a></h3>
<p>Wiemy juÅ¼ czego bÄ™dziemy uÅ¼ywaÄ‡, a wiec do dzieÅ‚a. Rozdzielmy najpierw obecny plik <code>tests.json</code> na dwa mniejsze.</p>
<p>Pierwszy plik nazwiemy <code>users_get.json</code> bÄ™dzie testowaÅ‚ API dotyczÄ…ce pobierania danych uÅ¼ytkownikÃ³w z testowanej aplikacji:</p>
<pre class="code json"><a id="rest_code_57fd35e7dfd7423db592b8fcff7f2efd-1" name="rest_code_57fd35e7dfd7423db592b8fcff7f2efd-1"></a><span class="p">{</span>
<a id="rest_code_57fd35e7dfd7423db592b8fcff7f2efd-2" name="rest_code_57fd35e7dfd7423db592b8fcff7f2efd-2"></a>  <span class="nt">"test_get_all_users"</span><span class="p">:</span> <span class="p">{</span>
<a id="rest_code_57fd35e7dfd7423db592b8fcff7f2efd-3" name="rest_code_57fd35e7dfd7423db592b8fcff7f2efd-3"></a>    <span class="nt">"request"</span><span class="p">:</span> <span class="p">{</span>
<a id="rest_code_57fd35e7dfd7423db592b8fcff7f2efd-4" name="rest_code_57fd35e7dfd7423db592b8fcff7f2efd-4"></a>      <span class="nt">"method"</span><span class="p">:</span> <span class="s2">"GET"</span><span class="p">,</span>
<a id="rest_code_57fd35e7dfd7423db592b8fcff7f2efd-5" name="rest_code_57fd35e7dfd7423db592b8fcff7f2efd-5"></a>      <span class="nt">"url"</span><span class="p">:</span> <span class="s2">"https://reqres.in/api/users"</span>
<a id="rest_code_57fd35e7dfd7423db592b8fcff7f2efd-6" name="rest_code_57fd35e7dfd7423db592b8fcff7f2efd-6"></a>    <span class="p">},</span>
<a id="rest_code_57fd35e7dfd7423db592b8fcff7f2efd-7" name="rest_code_57fd35e7dfd7423db592b8fcff7f2efd-7"></a>    <span class="nt">"assert"</span><span class="p">:</span> <span class="p">{</span>
<a id="rest_code_57fd35e7dfd7423db592b8fcff7f2efd-8" name="rest_code_57fd35e7dfd7423db592b8fcff7f2efd-8"></a>      <span class="nt">"statusCode"</span><span class="p">:</span> <span class="mi">200</span><span class="p">,</span>
<a id="rest_code_57fd35e7dfd7423db592b8fcff7f2efd-9" name="rest_code_57fd35e7dfd7423db592b8fcff7f2efd-9"></a>      <span class="nt">"responseKeys"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"page"</span><span class="p">,</span> <span class="s2">"total"</span><span class="p">,</span> <span class="s2">"per_page"</span><span class="p">,</span> <span class="s2">"total_pages"</span><span class="p">,</span> <span class="s2">"data"</span><span class="p">,</span> <span class="s2">"support"</span><span class="p">],</span>
<a id="rest_code_57fd35e7dfd7423db592b8fcff7f2efd-10" name="rest_code_57fd35e7dfd7423db592b8fcff7f2efd-10"></a>      <span class="nt">"responseTime"</span><span class="p">:</span> <span class="mf">0.300</span>
<a id="rest_code_57fd35e7dfd7423db592b8fcff7f2efd-11" name="rest_code_57fd35e7dfd7423db592b8fcff7f2efd-11"></a>    <span class="p">}</span>
<a id="rest_code_57fd35e7dfd7423db592b8fcff7f2efd-12" name="rest_code_57fd35e7dfd7423db592b8fcff7f2efd-12"></a>  <span class="p">},</span>
<a id="rest_code_57fd35e7dfd7423db592b8fcff7f2efd-13" name="rest_code_57fd35e7dfd7423db592b8fcff7f2efd-13"></a>  <span class="nt">"test_get_users_id_2"</span><span class="p">:</span> <span class="p">{</span>
<a id="rest_code_57fd35e7dfd7423db592b8fcff7f2efd-14" name="rest_code_57fd35e7dfd7423db592b8fcff7f2efd-14"></a>    <span class="nt">"request"</span><span class="p">:</span> <span class="p">{</span>
<a id="rest_code_57fd35e7dfd7423db592b8fcff7f2efd-15" name="rest_code_57fd35e7dfd7423db592b8fcff7f2efd-15"></a>      <span class="nt">"method"</span><span class="p">:</span> <span class="s2">"GET"</span><span class="p">,</span>
<a id="rest_code_57fd35e7dfd7423db592b8fcff7f2efd-16" name="rest_code_57fd35e7dfd7423db592b8fcff7f2efd-16"></a>      <span class="nt">"url"</span><span class="p">:</span> <span class="s2">"https://reqres.in/api/users/2"</span>
<a id="rest_code_57fd35e7dfd7423db592b8fcff7f2efd-17" name="rest_code_57fd35e7dfd7423db592b8fcff7f2efd-17"></a>    <span class="p">},</span>
<a id="rest_code_57fd35e7dfd7423db592b8fcff7f2efd-18" name="rest_code_57fd35e7dfd7423db592b8fcff7f2efd-18"></a>    <span class="nt">"assert"</span><span class="p">:</span> <span class="p">{</span>
<a id="rest_code_57fd35e7dfd7423db592b8fcff7f2efd-19" name="rest_code_57fd35e7dfd7423db592b8fcff7f2efd-19"></a>      <span class="nt">"statusCode"</span><span class="p">:</span> <span class="mi">200</span><span class="p">,</span>
<a id="rest_code_57fd35e7dfd7423db592b8fcff7f2efd-20" name="rest_code_57fd35e7dfd7423db592b8fcff7f2efd-20"></a>      <span class="nt">"responseKeys"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"data"</span><span class="p">,</span> <span class="s2">"support"</span><span class="p">],</span>
<a id="rest_code_57fd35e7dfd7423db592b8fcff7f2efd-21" name="rest_code_57fd35e7dfd7423db592b8fcff7f2efd-21"></a>      <span class="nt">"responseTime"</span><span class="p">:</span> <span class="mf">0.300</span>
<a id="rest_code_57fd35e7dfd7423db592b8fcff7f2efd-22" name="rest_code_57fd35e7dfd7423db592b8fcff7f2efd-22"></a>    <span class="p">}</span>
<a id="rest_code_57fd35e7dfd7423db592b8fcff7f2efd-23" name="rest_code_57fd35e7dfd7423db592b8fcff7f2efd-23"></a>  <span class="p">},</span>
<a id="rest_code_57fd35e7dfd7423db592b8fcff7f2efd-24" name="rest_code_57fd35e7dfd7423db592b8fcff7f2efd-24"></a>  <span class="nt">"test_get_non_existing_user"</span><span class="p">:</span> <span class="p">{</span>
<a id="rest_code_57fd35e7dfd7423db592b8fcff7f2efd-25" name="rest_code_57fd35e7dfd7423db592b8fcff7f2efd-25"></a>    <span class="nt">"request"</span><span class="p">:</span> <span class="p">{</span>
<a id="rest_code_57fd35e7dfd7423db592b8fcff7f2efd-26" name="rest_code_57fd35e7dfd7423db592b8fcff7f2efd-26"></a>      <span class="nt">"method"</span><span class="p">:</span> <span class="s2">"GET"</span><span class="p">,</span>
<a id="rest_code_57fd35e7dfd7423db592b8fcff7f2efd-27" name="rest_code_57fd35e7dfd7423db592b8fcff7f2efd-27"></a>      <span class="nt">"url"</span><span class="p">:</span> <span class="s2">"https://reqres.in/api/users/23"</span>
<a id="rest_code_57fd35e7dfd7423db592b8fcff7f2efd-28" name="rest_code_57fd35e7dfd7423db592b8fcff7f2efd-28"></a>    <span class="p">},</span>
<a id="rest_code_57fd35e7dfd7423db592b8fcff7f2efd-29" name="rest_code_57fd35e7dfd7423db592b8fcff7f2efd-29"></a>    <span class="nt">"assert"</span><span class="p">:</span> <span class="p">{</span>
<a id="rest_code_57fd35e7dfd7423db592b8fcff7f2efd-30" name="rest_code_57fd35e7dfd7423db592b8fcff7f2efd-30"></a>      <span class="nt">"statusCode"</span><span class="p">:</span> <span class="mi">404</span><span class="p">,</span>
<a id="rest_code_57fd35e7dfd7423db592b8fcff7f2efd-31" name="rest_code_57fd35e7dfd7423db592b8fcff7f2efd-31"></a>      <span class="nt">"responseKeys"</span><span class="p">:</span> <span class="p">[],</span>
<a id="rest_code_57fd35e7dfd7423db592b8fcff7f2efd-32" name="rest_code_57fd35e7dfd7423db592b8fcff7f2efd-32"></a>      <span class="nt">"responseTime"</span><span class="p">:</span> <span class="mf">0.300</span>
<a id="rest_code_57fd35e7dfd7423db592b8fcff7f2efd-33" name="rest_code_57fd35e7dfd7423db592b8fcff7f2efd-33"></a>    <span class="p">}</span>
<a id="rest_code_57fd35e7dfd7423db592b8fcff7f2efd-34" name="rest_code_57fd35e7dfd7423db592b8fcff7f2efd-34"></a>  <span class="p">}</span>
<a id="rest_code_57fd35e7dfd7423db592b8fcff7f2efd-35" name="rest_code_57fd35e7dfd7423db592b8fcff7f2efd-35"></a><span class="p">}</span>
</pre>
<p>Drugi plik nazwiemy <code>users_create.json</code> bÄ™dzie testowaÅ‚ API dotyczÄ…ce tworzenia nowych uÅ¼ytkownikÃ³w w testowanej aplikacji:</p>
<pre class="code json"><a id="rest_code_3b2b94e5bce74629add37a27b9d995c1-1" name="rest_code_3b2b94e5bce74629add37a27b9d995c1-1"></a><span class="p">{</span>
<a id="rest_code_3b2b94e5bce74629add37a27b9d995c1-2" name="rest_code_3b2b94e5bce74629add37a27b9d995c1-2"></a>  <span class="nt">"test_create_new_user"</span><span class="p">:</span> <span class="p">{</span>
<a id="rest_code_3b2b94e5bce74629add37a27b9d995c1-3" name="rest_code_3b2b94e5bce74629add37a27b9d995c1-3"></a>    <span class="nt">"request"</span><span class="p">:</span> <span class="p">{</span>
<a id="rest_code_3b2b94e5bce74629add37a27b9d995c1-4" name="rest_code_3b2b94e5bce74629add37a27b9d995c1-4"></a>      <span class="nt">"method"</span><span class="p">:</span> <span class="s2">"POST"</span><span class="p">,</span>
<a id="rest_code_3b2b94e5bce74629add37a27b9d995c1-5" name="rest_code_3b2b94e5bce74629add37a27b9d995c1-5"></a>      <span class="nt">"url"</span><span class="p">:</span> <span class="s2">"https://reqres.in/api/users"</span><span class="p">,</span>
<a id="rest_code_3b2b94e5bce74629add37a27b9d995c1-6" name="rest_code_3b2b94e5bce74629add37a27b9d995c1-6"></a>      <span class="nt">"json"</span><span class="p">:</span> <span class="p">{</span>
<a id="rest_code_3b2b94e5bce74629add37a27b9d995c1-7" name="rest_code_3b2b94e5bce74629add37a27b9d995c1-7"></a>        <span class="nt">"name"</span><span class="p">:</span> <span class="s2">"testerembyc"</span><span class="p">,</span>
<a id="rest_code_3b2b94e5bce74629add37a27b9d995c1-8" name="rest_code_3b2b94e5bce74629add37a27b9d995c1-8"></a>        <span class="nt">"jon"</span><span class="p">:</span> <span class="s2">"tester"</span>
<a id="rest_code_3b2b94e5bce74629add37a27b9d995c1-9" name="rest_code_3b2b94e5bce74629add37a27b9d995c1-9"></a>      <span class="p">}</span>
<a id="rest_code_3b2b94e5bce74629add37a27b9d995c1-10" name="rest_code_3b2b94e5bce74629add37a27b9d995c1-10"></a>    <span class="p">},</span>
<a id="rest_code_3b2b94e5bce74629add37a27b9d995c1-11" name="rest_code_3b2b94e5bce74629add37a27b9d995c1-11"></a>    <span class="nt">"assert"</span><span class="p">:</span> <span class="p">{</span>
<a id="rest_code_3b2b94e5bce74629add37a27b9d995c1-12" name="rest_code_3b2b94e5bce74629add37a27b9d995c1-12"></a>      <span class="nt">"statusCode"</span><span class="p">:</span> <span class="mi">201</span><span class="p">,</span>
<a id="rest_code_3b2b94e5bce74629add37a27b9d995c1-13" name="rest_code_3b2b94e5bce74629add37a27b9d995c1-13"></a>      <span class="nt">"responseKeys"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"name"</span><span class="p">,</span> <span class="s2">"jon"</span><span class="p">,</span> <span class="s2">"id"</span><span class="p">,</span> <span class="s2">"createdAt"</span><span class="p">],</span>
<a id="rest_code_3b2b94e5bce74629add37a27b9d995c1-14" name="rest_code_3b2b94e5bce74629add37a27b9d995c1-14"></a>      <span class="nt">"responseTime"</span><span class="p">:</span> <span class="mf">0.300</span>
<a id="rest_code_3b2b94e5bce74629add37a27b9d995c1-15" name="rest_code_3b2b94e5bce74629add37a27b9d995c1-15"></a>    <span class="p">}</span>
<a id="rest_code_3b2b94e5bce74629add37a27b9d995c1-16" name="rest_code_3b2b94e5bce74629add37a27b9d995c1-16"></a>  <span class="p">}</span>
<a id="rest_code_3b2b94e5bce74629add37a27b9d995c1-17" name="rest_code_3b2b94e5bce74629add37a27b9d995c1-17"></a><span class="p">}</span>
</pre>
<p>ZauwaÅ¼, Å¼e te pliki to tylko prosty podziaÅ‚ i nie nastÄ…piÅ‚a Å¼adna modyfikacja danych, ktÃ³re oryginalnie zawarte byÅ‚y w pliku <code>tests.json</code>.</p>
<p>PrzejdÅºmy teraz do wprowadzenia zmian w kodzie:</p>
<pre class="code python"><a id="rest_code_6ee74151ebf440ca975ce39550f42676-1" name="rest_code_6ee74151ebf440ca975ce39550f42676-1"></a><span class="kn">import</span> <span class="nn">unittest</span><span class="o">,</span> <span class="nn">xmlrunner</span><span class="o">,</span> <span class="nn">json</span><span class="o">,</span> <span class="nn">requests</span><span class="o">,</span> <span class="nn">glob</span>
<a id="rest_code_6ee74151ebf440ca975ce39550f42676-2" name="rest_code_6ee74151ebf440ca975ce39550f42676-2"></a>
<a id="rest_code_6ee74151ebf440ca975ce39550f42676-3" name="rest_code_6ee74151ebf440ca975ce39550f42676-3"></a><span class="k">def</span> <span class="nf">abstract_test</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
<a id="rest_code_6ee74151ebf440ca975ce39550f42676-4" name="rest_code_6ee74151ebf440ca975ce39550f42676-4"></a>    <span class="n">response</span><span class="p">:</span> <span class="n">requests</span><span class="o">.</span><span class="n">Response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="o">**</span><span class="n">data</span><span class="p">[</span><span class="s1">'request'</span><span class="p">])</span>
<a id="rest_code_6ee74151ebf440ca975ce39550f42676-5" name="rest_code_6ee74151ebf440ca975ce39550f42676-5"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="s1">'assert'</span><span class="p">][</span><span class="s1">'statusCode'</span><span class="p">])</span>
<a id="rest_code_6ee74151ebf440ca975ce39550f42676-6" name="rest_code_6ee74151ebf440ca975ce39550f42676-6"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">assertSetEqual</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span><span class="o">.</span><span class="n">keys</span><span class="p">()),</span> <span class="nb">set</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">'assert'</span><span class="p">][</span><span class="s1">'responseKeys'</span><span class="p">]))</span>
<a id="rest_code_6ee74151ebf440ca975ce39550f42676-7" name="rest_code_6ee74151ebf440ca975ce39550f42676-7"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">assertLessEqual</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">elapsed</span><span class="o">.</span><span class="n">total_seconds</span><span class="p">(),</span> <span class="n">data</span><span class="p">[</span><span class="s1">'assert'</span><span class="p">][</span><span class="s1">'responseTime'</span><span class="p">])</span>
<a id="rest_code_6ee74151ebf440ca975ce39550f42676-8" name="rest_code_6ee74151ebf440ca975ce39550f42676-8"></a>
<a id="rest_code_6ee74151ebf440ca975ce39550f42676-9" name="rest_code_6ee74151ebf440ca975ce39550f42676-9"></a><span class="k">for</span> <span class="n">file_name</span> <span class="ow">in</span> <span class="n">glob</span><span class="o">.</span><span class="n">iglob</span><span class="p">(</span><span class="s2">"*.json"</span><span class="p">):</span>
<a id="rest_code_6ee74151ebf440ca975ce39550f42676-10" name="rest_code_6ee74151ebf440ca975ce39550f42676-10"></a>    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span> <span class="s1">'r'</span><span class="p">)</span> <span class="k">as</span> <span class="n">json_file</span><span class="p">:</span>
<a id="rest_code_6ee74151ebf440ca975ce39550f42676-11" name="rest_code_6ee74151ebf440ca975ce39550f42676-11"></a>        <span class="n">test</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">data</span><span class="p">:</span> <span class="k">lambda</span> <span class="bp">self</span><span class="p">:</span> <span class="n">abstract_test</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
<a id="rest_code_6ee74151ebf440ca975ce39550f42676-12" name="rest_code_6ee74151ebf440ca975ce39550f42676-12"></a>        <span class="n">suite_name</span> <span class="o">=</span> <span class="n">file_name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">'.'</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<a id="rest_code_6ee74151ebf440ca975ce39550f42676-13" name="rest_code_6ee74151ebf440ca975ce39550f42676-13"></a>        <span class="nb">globals</span><span class="p">()[</span><span class="n">suite_name</span><span class="p">]</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="n">suite_name</span><span class="p">,</span> <span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">,),</span> <span class="p">{</span><span class="n">name</span><span class="p">:</span> <span class="n">test</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">json_file</span><span class="p">)</span><span class="o">.</span><span class="n">items</span><span class="p">()})</span>
<a id="rest_code_6ee74151ebf440ca975ce39550f42676-14" name="rest_code_6ee74151ebf440ca975ce39550f42676-14"></a>
<a id="rest_code_6ee74151ebf440ca975ce39550f42676-15" name="rest_code_6ee74151ebf440ca975ce39550f42676-15"></a><span class="n">unittest</span><span class="o">.</span><span class="n">main</span><span class="p">(</span><span class="n">testRunner</span><span class="o">=</span><span class="n">xmlrunner</span><span class="o">.</span><span class="n">XMLTestRunner</span><span class="p">())</span>
</pre>
<p>WprowadziliÅ›my kilka drobnych zmian:</p>
<ol class="arabic simple">
<li>
<p>DodaliÅ›my pÄ™tle <code>for</code>, ktÃ³ra iteruje po znalezionych plikach <strong>json</strong>.</p>
</li>
<li>
<p>DodaliÅ›my zmiennÄ… <code>suite_name</code>, ktÃ³ra przechowuje nazwÄ™ suity testÃ³w, a ktÃ³ra jest nazwÄ… pliku <strong>json</strong> bez jego rozszerzenia.</p>
</li>
<li>
<p>W dynamiczny sposÃ³b dodajemy zmienne globalne, ktÃ³re sÄ… oddzielnymi klasami testÃ³w, gdzie kaÅ¼demu plikowi <strong>json</strong> odpowiada jedna klasa z testami.</p>
</li>
</ol>
<p>GdybyÅ›my teraz w naszym kodzie wyÅ›wietli zawartoÅ›Ä‡, ktÃ³rÄ… zwraca <code>globals()</code>, zauwaÅ¼ylibyÅ›my m.in. coÅ› takiego:</p>
<pre class="code python doctest">&gt;&gt;&gt; 'user_create': &lt;class '__main__.user_create'&gt;, 'user_get': &lt;class '__main__.user_get'&gt;
</pre>
<p>Ile mamy linii kodu? <strong>15</strong>. Uff. Dalej mieÅ›cimy siÄ™ w zakÅ‚adanych 16 linijkach kodu.</p>
</div>
</div>
<div class="section" id="podsumowanie">
<h2>Podsumowanie<a class="headerlink" href="#podsumowanie" title="Permalink to this heading">Â¶</a></h2>
<p>To byÅ‚a dosyÄ‡ dÅ‚uga przygoda (aÅ¼ dwa i to dosyÄ‡ rozbudowane wpisy na blogu). Sporo Pythonowych <em>trikÃ³w</em>, ktÃ³re na pierwszy rzut oka nie wydajÄ… siÄ™ oczywiste, ale pokazujÄ… potÄ™gÄ™ tego jÄ™zyka. Mam nadziejÄ™, Å¼e ta podrÃ³Å¼ zachÄ™ci CiÄ™ do poznawania zarÃ³wno bibliotek Pythonowych jakie moÅ¼na wykorzystaÄ‡ w testach oraz wewnÄ™trznych mechanizmÃ³w, jakie sÄ… w ten jÄ™zyk wbudowane.</p>
</div>
<div class="section" id="bonus">
<h2>Bonus<a class="headerlink" href="#bonus" title="Permalink to this heading">Â¶</a></h2>
<p>JeÅ›li jesteÅ› purystÄ… i najwaÅ¼niejszÄ… sprawÄ… dla Ciebie jest zgodnoÅ›Ä‡ kodu z <strong>PEP-8</strong> to poniÅ¼ej wersja tego frameworka, ktÃ³ra jest z nim zgodna oraz w dalszym ciÄ…gu mieÅ›ci siÄ™ w 16 linijkach kodu (sprawdza status odpowiedzi oraz wspiera wiele plikÃ³w <strong>json</strong>):</p>
<pre class="code python"><a id="rest_code_ef9086553b884c7f80093254c5d113d9-1" name="rest_code_ef9086553b884c7f80093254c5d113d9-1"></a><span class="kn">import</span> <span class="nn">unittest</span>
<a id="rest_code_ef9086553b884c7f80093254c5d113d9-2" name="rest_code_ef9086553b884c7f80093254c5d113d9-2"></a><span class="kn">import</span> <span class="nn">xmlrunner</span>
<a id="rest_code_ef9086553b884c7f80093254c5d113d9-3" name="rest_code_ef9086553b884c7f80093254c5d113d9-3"></a><span class="kn">import</span> <span class="nn">json</span>
<a id="rest_code_ef9086553b884c7f80093254c5d113d9-4" name="rest_code_ef9086553b884c7f80093254c5d113d9-4"></a><span class="kn">import</span> <span class="nn">requests</span>
<a id="rest_code_ef9086553b884c7f80093254c5d113d9-5" name="rest_code_ef9086553b884c7f80093254c5d113d9-5"></a><span class="kn">import</span> <span class="nn">glob</span>
<a id="rest_code_ef9086553b884c7f80093254c5d113d9-6" name="rest_code_ef9086553b884c7f80093254c5d113d9-6"></a>
<a id="rest_code_ef9086553b884c7f80093254c5d113d9-7" name="rest_code_ef9086553b884c7f80093254c5d113d9-7"></a><span class="k">for</span> <span class="n">file_name</span> <span class="ow">in</span> <span class="n">glob</span><span class="o">.</span><span class="n">iglob</span><span class="p">(</span><span class="s2">"*.json"</span><span class="p">):</span>
<a id="rest_code_ef9086553b884c7f80093254c5d113d9-8" name="rest_code_ef9086553b884c7f80093254c5d113d9-8"></a>    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span> <span class="s1">'r'</span><span class="p">)</span> <span class="k">as</span> <span class="n">json_file</span><span class="p">:</span>
<a id="rest_code_ef9086553b884c7f80093254c5d113d9-9" name="rest_code_ef9086553b884c7f80093254c5d113d9-9"></a>        <span class="n">tests_dict</span> <span class="o">=</span> <span class="p">{</span><span class="n">name</span><span class="p">:</span> <span class="p">(</span><span class="k">lambda</span> <span class="n">data</span><span class="p">:</span> <span class="k">lambda</span> <span class="bp">self</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span>
<a id="rest_code_ef9086553b884c7f80093254c5d113d9-10" name="rest_code_ef9086553b884c7f80093254c5d113d9-10"></a>            <span class="n">requests</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="o">**</span><span class="n">data</span><span class="p">[</span><span class="s1">'request'</span><span class="p">])</span><span class="o">.</span><span class="n">status_code</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="s1">'assert'</span><span class="p">][</span><span class="s1">'statusCode'</span><span class="p">]))(</span><span class="n">data</span><span class="p">)</span>
<a id="rest_code_ef9086553b884c7f80093254c5d113d9-11" name="rest_code_ef9086553b884c7f80093254c5d113d9-11"></a>                      <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">json_file</span><span class="p">)</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
<a id="rest_code_ef9086553b884c7f80093254c5d113d9-12" name="rest_code_ef9086553b884c7f80093254c5d113d9-12"></a>        <span class="n">suite_name</span> <span class="o">=</span> <span class="n">file_name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">'.'</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<a id="rest_code_ef9086553b884c7f80093254c5d113d9-13" name="rest_code_ef9086553b884c7f80093254c5d113d9-13"></a>        <span class="nb">globals</span><span class="p">()[</span><span class="n">suite_name</span><span class="p">]</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="n">suite_name</span><span class="p">,</span> <span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">,),</span> <span class="n">tests_dict</span><span class="p">)</span>
<a id="rest_code_ef9086553b884c7f80093254c5d113d9-14" name="rest_code_ef9086553b884c7f80093254c5d113d9-14"></a>
<a id="rest_code_ef9086553b884c7f80093254c5d113d9-15" name="rest_code_ef9086553b884c7f80093254c5d113d9-15"></a><span class="n">unittest</span><span class="o">.</span><span class="n">main</span><span class="p">(</span><span class="n">testRunner</span><span class="o">=</span><span class="n">xmlrunner</span><span class="o">.</span><span class="n">XMLTestRunner</span><span class="p">())</span>
</pre>
<p>Dodatkowo linki do repozytorium z najciekawszymi (wedÅ‚ug mnie) wersjami kodu, ktÃ³ry omawialiÅ›my w tej mini serii znajdziesz poniÅ¼ej:</p>
<ul class="simple">
<li>
<p><a class="reference external" href="https://github.com/mkusz/the_smallest_rest_api_testing_framework/tree/first_article">pierwszy artykuÅ‚</a>,</p>
</li>
<li>
<p><a class="reference external" href="https://github.com/mkusz/the_smallest_rest_api_testing_framework/tree/more_functionality">wiÄ™cej funkcjonalnoÅ›ci</a>,</p>
</li>
<li>
<p><a class="reference external" href="https://github.com/mkusz/the_smallest_rest_api_testing_framework/tree/6_lines">tylko 6 linii kodu</a>,</p>
</li>
<li>
<p><a class="reference external" href="https://github.com/mkusz/the_smallest_rest_api_testing_framework/tree/pep8_valid">zgodnoÅ›Ä‡ z PEP-8</a>.</p>
</li>
</ul>
</div>
<div class="section" id="bonus-2">
<h2>Bonus 2<a class="headerlink" href="#bonus-2" title="Permalink to this heading">Â¶</a></h2>
<p>Po raz kolejny <strong>Jakub SpÃ³rna</strong> z bloga <a class="reference external" href="https://sporna.dev/">https://sporna.dev/</a> podrzuciÅ‚ jeszcze innÄ… wersjÄ™ frameworka. Tym razem wziÄ…Å‚ na tapetÄ™ wersjÄ™ najbardziej rozbudowanÄ… funkcjonalnoÅ›Ä‡ i postanowiÅ‚ jÄ… ciut bardziej pomniejszyÄ‡. PoniÅ¼ej jego wersja (z minimalnÄ… modyfikacjÄ… dotyczÄ…cej nazw plikÃ³Å“):</p>
<pre class="code python"><a id="rest_code_89bb6a7cdfd84c138c8a8316b76bb791-1" name="rest_code_89bb6a7cdfd84c138c8a8316b76bb791-1"></a><span class="kn">import</span> <span class="nn">unittest</span><span class="o">,</span> <span class="nn">xmlrunner</span><span class="o">,</span> <span class="nn">json</span><span class="o">,</span> <span class="nn">requests</span><span class="o">,</span> <span class="nn">glob</span>
<a id="rest_code_89bb6a7cdfd84c138c8a8316b76bb791-2" name="rest_code_89bb6a7cdfd84c138c8a8316b76bb791-2"></a>
<a id="rest_code_89bb6a7cdfd84c138c8a8316b76bb791-3" name="rest_code_89bb6a7cdfd84c138c8a8316b76bb791-3"></a><span class="k">def</span> <span class="nf">abstract_test</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">response</span><span class="p">):</span>
<a id="rest_code_89bb6a7cdfd84c138c8a8316b76bb791-4" name="rest_code_89bb6a7cdfd84c138c8a8316b76bb791-4"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="s1">'assert'</span><span class="p">][</span><span class="s1">'statusCode'</span><span class="p">])</span>
<a id="rest_code_89bb6a7cdfd84c138c8a8316b76bb791-5" name="rest_code_89bb6a7cdfd84c138c8a8316b76bb791-5"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">assertSetEqual</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span><span class="o">.</span><span class="n">keys</span><span class="p">()),</span> <span class="nb">set</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">'assert'</span><span class="p">][</span><span class="s1">'responseKeys'</span><span class="p">]))</span>
<a id="rest_code_89bb6a7cdfd84c138c8a8316b76bb791-6" name="rest_code_89bb6a7cdfd84c138c8a8316b76bb791-6"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">assertLessEqual</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">elapsed</span><span class="o">.</span><span class="n">total_seconds</span><span class="p">(),</span> <span class="n">data</span><span class="p">[</span><span class="s1">'assert'</span><span class="p">][</span><span class="s1">'responseTime'</span><span class="p">])</span>
<a id="rest_code_89bb6a7cdfd84c138c8a8316b76bb791-7" name="rest_code_89bb6a7cdfd84c138c8a8316b76bb791-7"></a>
<a id="rest_code_89bb6a7cdfd84c138c8a8316b76bb791-8" name="rest_code_89bb6a7cdfd84c138c8a8316b76bb791-8"></a><span class="n">test</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">data</span><span class="p">:</span> <span class="k">lambda</span> <span class="bp">self</span><span class="p">:</span> <span class="n">abstract_test</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">requests</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="o">**</span><span class="n">data</span><span class="p">[</span><span class="s1">'request'</span><span class="p">]))</span>
<a id="rest_code_89bb6a7cdfd84c138c8a8316b76bb791-9" name="rest_code_89bb6a7cdfd84c138c8a8316b76bb791-9"></a><span class="nb">globals</span><span class="p">()</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">file_name</span><span class="p">:</span> <span class="nb">type</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span> <span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">,</span> <span class="p">),</span> <span class="p">{</span><span class="n">name</span><span class="p">:</span> <span class="n">test</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span> <span class="s1">'r'</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">())</span><span class="o">.</span><span class="n">items</span><span class="p">()})</span> <span class="k">for</span> <span class="n">file_name</span> <span class="ow">in</span> <span class="n">glob</span><span class="o">.</span><span class="n">iglob</span><span class="p">(</span><span class="s2">"*.json"</span><span class="p">)})</span>
<a id="rest_code_89bb6a7cdfd84c138c8a8316b76bb791-10" name="rest_code_89bb6a7cdfd84c138c8a8316b76bb791-10"></a><span class="n">unittest</span><span class="o">.</span><span class="n">main</span><span class="p">(</span><span class="n">testRunner</span><span class="o">=</span><span class="n">xmlrunner</span><span class="o">.</span><span class="n">XMLTestRunner</span><span class="p">())</span>
</pre>
<p>Nie bÄ™dÄ™ juÅ¼ analizowaÅ‚ zmian, gdyÅ¼ pozostawiÄ™ to dla Ciebie w ramach treningu.</p>
</div>
</div>
<div class="col-md-6"><img src="../../images/page_lm/jak_zaczac_automatyzowac.jpg"></div>
<div class="col-md-6">
<form action="https://maciejkusz.activehosted.com/proc.php" id="_form_5_" method="post" name="_form_5_" novalidate=""><input name="u" type="hidden" value="5"><input name="f" type="hidden" value="5"><input name="s" type="hidden"><input name="c" type="hidden" value="0"><input name="m" type="hidden" value="0"><input name="act" type="hidden" value="sub"><input name="v" type="hidden" value="2">
<h3>Zapraszam do newslettera<a class="headerlink" href="#_form_5_" title="Permalink to this heading">Â¶</a></h3>
<div class="_form-content">
<p>JeÅ›li powyÅ¼szy artykuÅ‚ uznajesz za wartoÅ›ciowy oraz masz ochotÄ™ byÄ‡ informowany o nowoÅ›ciach na moim blogu, to zachÄ™cam CiÄ™ do zapisania siÄ™ do mojego newslettera. ObiecujÄ™, Å¼e nie bÄ™dÄ™ CiÄ™ spamowaÅ‚, a tylko czasu do czasu wyÅ›lÄ™ Ci powiadomienie o nowym artykule lub przeÅ›lÄ™ krÃ³tkiego maila z ciekawymi informacjami.<br>
<strong>BONUS:</strong> Dodatkowo otrzymasz mÃ³j mini poradnik: <em>Jak zaczÄ…Ä‡ automatyzowaÄ‡ testy? Czyli 12 pytaÅ„ i odpowiedzi, ktÃ³re w tym pomogÄ…</em></p>
<div class="input-group" id="basic-fullname-group"><span class="input-group-addon" id="basic-fullname">ImiÄ™</span> <input aria-describedby="basic-fullname" class="form-control" name="fullname" placeholder="Wpisz swoje imiÄ™" type="text"></div>
<div class="input-group" id="basic-lastname-group"><span class="input-group-addon" id="basic-lastname">Nazwisko</span> <input aria-describedby="basic-fullname" class="form-control" name="lastname" placeholder="Wpisz swoje nazwisko" type="text"></div>
<div class="input-group" id="basic-email-group"><span class="input-group-addon" id="basic-email">E-mail</span> <input aria-describedby="basic-email" class="form-control" name="email" placeholder="Wpisz swÃ³j e-mail" required="" type="text"></div>
<button class="_submit btn btn-danger" id="_form_5_submit" style="margin-left: auto; margin-right: auto; display: block;" type="submit">Zapisz siÄ™</button>
<div class="_clear-element"></div>
</div>
<div class="_form-thank-you" style="display:none;"></div>
<p style="font-size: 10px; margin-top: 5px;">Wszystkie podane przez Ciebie dane, bÄ™dÄ… przetwarzane zgodnie z <a href="../../pages/polityka-prywatnosci">politykÄ… prywatnoÅ›ci</a>.</p>
</form>
<script type="text/javascript">
        window.cfields = [];
        window._show_thank_you = function(id, message, trackcmp_url) {
          var form = document.getElementById('_form_' + id + '_'), thank_you = form.querySelector('._form-thank-you');
          form.querySelector('._form-content').style.display = 'none';
          thank_you.innerHTML = message;
          thank_you.style.display = 'block';
          if (typeof(trackcmp_url) != 'undefined' && trackcmp_url) {
            // Site tracking URL to use after inline form submission.
            _load_script(trackcmp_url);
          }
          if (typeof window._form_callback !== 'undefined') window._form_callback(id);
        };
        window._show_error = function(id, message, html) {
          var form = document.getElementById('_form_' + id + '_'), err = document.createElement('div'), button = form.querySelector('button'), old_error = form.querySelector('._form_error');
          if (old_error) old_error.parentNode.removeChild(old_error);
          err.innerHTML = message;
          err.className = '_error-inner _form_error _no_arrow';
          var wrapper = document.createElement('div');
          wrapper.className = '_form-inner';
          wrapper.appendChild(err);
          button.parentNode.insertBefore(wrapper, button);
          document.querySelector('[id^="_form"][id$="_submit"]').disabled = false;
          if (html) {
            var div = document.createElement('div');
            div.className = '_error-html';
            div.innerHTML = html;
            err.appendChild(div);
          }
        };
        window._load_script = function(url, callback) {
            var head = document.querySelector('head'), script = document.createElement('script'), r = false;
            script.type = 'text/javascript';
            script.charset = 'utf-8';
            script.src = url;
            if (callback) {
              script.onload = script.onreadystatechange = function() {
              if (!r && (!this.readyState || this.readyState == 'complete')) {
                r = true;
                callback();
                }
              };
            }
            head.appendChild(script);
        };
        (function() {
          if (window.location.search.search("excludeform") !== -1) return false;
          var getCookie = function(name) {
            var match = document.cookie.match(new RegExp('(^|; )' + name + '=([^;]+)'));
            return match ? match[2] : null;
          }
          var setCookie = function(name, value) {
            var now = new Date();
            var time = now.getTime();
            var expireTime = time + 1000 * 60 * 60 * 24 * 365;
            now.setTime(expireTime);
            document.cookie = name + '=' + value + '; expires=' + now + ';path=/';
          }
              var addEvent = function(element, event, func) {
            if (element.addEventListener) {
              element.addEventListener(event, func);
            } else {
              var oldFunc = element['on' + event];
              element['on' + event] = function() {
                oldFunc.apply(this, arguments);
                func.apply(this, arguments);
              };
            }
          }
          var _removed = false;
          var form_to_submit = document.getElementById('_form_5_');
          var allInputs = form_to_submit.querySelectorAll('input, select, textarea'), tooltips = [], submitted = false;

          var getUrlParam = function(name) {
            var regexStr = '[\?&]' + name + '=([^&#]*)';
            var results = new RegExp(regexStr, 'i').exec(window.location.href);
            return results != undefined ? decodeURIComponent(results[1]) : false;
          };

          for (var i = 0; i < allInputs.length; i++) {
            var regexStr = "field\\[(\\d+)\\]";
            var results = new RegExp(regexStr).exec(allInputs[i].name);
            if (results != undefined) {
              allInputs[i].dataset.name = window.cfields[results[1]];
            } else {
              allInputs[i].dataset.name = allInputs[i].name;
            }
            var fieldVal = getUrlParam(allInputs[i].dataset.name);

            if (fieldVal) {
                    if (allInputs[i].dataset.autofill === "false") {
                        continue;
                    }
              if (allInputs[i].type == "radio" || allInputs[i].type == "checkbox") {
                if (allInputs[i].value == fieldVal) {
                  allInputs[i].checked = true;
                }
              } else {
                allInputs[i].value = fieldVal;
              }
            }
          }

          var remove_tooltips = function() {
            for (var i = 0; i < tooltips.length; i++) {
              tooltips[i].tip.parentNode.removeChild(tooltips[i].tip);
            }
              tooltips = [];
          };
          var remove_tooltip = function(elem) {
            for (var i = 0; i < tooltips.length; i++) {
              if (tooltips[i].elem === elem) {
                tooltips[i].tip.parentNode.removeChild(tooltips[i].tip);
                tooltips.splice(i, 1);
                return;
              }
            }
          };
          var create_tooltip = function(elem, text) {
            var tooltip = document.createElement('div'), arrow = document.createElement('div'), inner = document.createElement('div'), new_tooltip = {};
            if (elem.type != 'radio' && elem.type != 'checkbox') {
              tooltip.className = 'label label-danger';
              tooltip.innerHTML = text;
              elem.parentNode.parentNode.insertBefore(tooltip, elem.parentNode);
            } else {
              tooltip.className = '_error-inner _no_arrow';
              tooltip.innerHTML = text;
              elem.parentNode.insertBefore(tooltip, elem);
              new_tooltip.no_arrow = true;
            }
            new_tooltip.tip = tooltip;
            new_tooltip.elem = elem;
            tooltips.push(new_tooltip);
            return new_tooltip;
          };
          var resize_tooltip = function(tooltip) {
            var rect = tooltip.elem.getBoundingClientRect();
            var doc = document.documentElement, scrollPosition = rect.top - ((window.pageYOffset || doc.scrollTop)  - (doc.clientTop || 0));
            if (scrollPosition < 40) {
              tooltip.tip.className = tooltip.tip.className.replace(/ ?(_above|_below) ?/g, '') + ' _below';
            } else {
              tooltip.tip.className = tooltip.tip.className.replace(/ ?(_above|_below) ?/g, '') + ' _above';
            }
          };
          var resize_tooltips = function() {
            if (_removed) return;
            for (var i = 0; i < tooltips.length; i++) {
              if (!tooltips[i].no_arrow) resize_tooltip(tooltips[i]);
            }
          };
          var validate_field = function(elem, remove) {
            var tooltip = null, value = elem.value, no_error = true;
            remove ? remove_tooltip(elem) : false;
            if (elem.type != 'checkbox') elem.className = elem.className.replace(/ ?_has_error ?/g, '');
            if (elem.getAttribute('required') !== null) {
              if (elem.type == 'radio' || (elem.type == 'checkbox' && /any/.test(elem.className))) {
                var elems = form_to_submit.elements[elem.name];
                if (!(elems instanceof NodeList || elems instanceof HTMLCollection) || elems.length <= 1) {
                  no_error = elem.checked;
                }
                else {
                  no_error = false;
                  for (var i = 0; i < elems.length; i++) {
                    if (elems[i].checked) no_error = true;
                  }
                }
                if (!no_error) {
                  tooltip = create_tooltip(elem, "Wybierz opcjÄ™.");
                }
              } else if (elem.type =='checkbox') {
                var elems = form_to_submit.elements[elem.name], found = false, err = [];
                no_error = true;
                for (var i = 0; i < elems.length; i++) {
                  if (elems[i].getAttribute('required') === null) continue;
                  if (!found && elems[i] !== elem) return true;
                  found = true;
                  elems[i].className = elems[i].className.replace(/ ?_has_error ?/g, '');
                  if (!elems[i].checked) {
                    no_error = false;
                    elems[i].className = elems[i].className + ' _has_error';
                    err.push("Zaznaczenie %s jest wymagane".replace("%s", elems[i].value));
                  }
                }
                if (!no_error) {
                  tooltip = create_tooltip(elem, err.join('<br/>'));
                }
              } else if (elem.tagName == 'SELECT') {
                var selected = true;
                if (elem.multiple) {
                  selected = false;
                  for (var i = 0; i < elem.options.length; i++) {
                    if (elem.options[i].selected) {
                      selected = true;
                      break;
                    }
                  }
                } else {
                  for (var i = 0; i < elem.options.length; i++) {
                    if (elem.options[i].selected && !elem.options[i].value) {
                      selected = false;
                    }
                  }
                }
                if (!selected) {
                  elem.className = elem.className + ' _has_error';
                  no_error = false;
                  tooltip = create_tooltip(elem, "Wybierz opcjÄ™.");
                }
              } else if (value === undefined || value === null || value === '') {
                elem.className = elem.className + ' _has_error';
                no_error = false;
                tooltip = create_tooltip(elem, "To pole jest wymagane.");
              }
            }
            if (no_error && elem.name == 'email') {
              if (!value.match(/^[\+_a-z0-9-'&=]+(\.[\+_a-z0-9-']+)*@[a-z0-9-]+(\.[a-z0-9-]+)*(\.[a-z]{2,})$/i)) {
                elem.className = elem.className + ' _has_error';
                no_error = false;
                tooltip = create_tooltip(elem, "Wpisz poprawny adres e-mail.");
              }
            }
            if (no_error && /date_field/.test(elem.className)) {
              if (!value.match(/^\d\d\d\d-\d\d-\d\d$/)) {
                elem.className = elem.className + ' _has_error';
                no_error = false;
                tooltip = create_tooltip(elem, "Wpisz poprawnÄ… datÄ™.");
              }
            }
            tooltip ? resize_tooltip(tooltip) : false;
            return no_error;
          };
          var needs_validate = function(el) {
            return el.name == 'email' || el.getAttribute('required') !== null;
          };
          var validate_form = function(e) {
            var err = form_to_submit.querySelector('._form_error'), no_error = true;
            if (!submitted) {
              submitted = true;
              for (var i = 0, len = allInputs.length; i < len; i++) {
                var input = allInputs[i];
                if (needs_validate(input)) {
                  if (input.type == 'text') {
                    addEvent(input, 'blur', function() {
                      this.value = this.value.trim();
                      validate_field(this, true);
                    });
                    addEvent(input, 'input', function() {
                      validate_field(this, true);
                    });
                  } else if (input.type == 'radio' || input.type == 'checkbox') {
                    (function(el) {
                      var radios = form_to_submit.elements[el.name];
                      for (var i = 0; i < radios.length; i++) {
                        addEvent(radios[i], 'click', function() {
                          validate_field(el, true);
                        });
                      }
                    })(input);
                  } else if (input.tagName == 'SELECT') {
                    addEvent(input, 'change', function() {
                      validate_field(this, true);
                    });
                  } else if (input.type == 'textarea'){
                    addEvent(input, 'input', function() {
                      validate_field(this, true);
                    });
                  }
                }
              }
            }
            remove_tooltips();
            for (var i = 0, len = allInputs.length; i < len; i++) {
              var elem = allInputs[i];
              if (needs_validate(elem)) {
                if (elem.tagName.toLowerCase() !== "select") {
                  elem.value = elem.value.trim();
                }
                validate_field(elem) ? true : no_error = false;
              }
            }
            if (!no_error && e) {
              e.preventDefault();
            }
            resize_tooltips();
            return no_error;
          };
          addEvent(window, 'resize', resize_tooltips);
          addEvent(window, 'scroll', resize_tooltips);
          window._old_serialize = null;
          if (typeof serialize !== 'undefined') window._old_serialize = window.serialize;
          _load_script("//d3rxaij56vjege.cloudfront.net/form-serialize/0.3/serialize.min.js", function() {
            window._form_serialize = window.serialize;
            if (window._old_serialize) window.serialize = window._old_serialize;
          });
          var form_submit = function(e) {
            e.preventDefault();
            if (validate_form()) {
              // use this trick to get the submit button & disable it using plain javascript
              document.querySelector('#_form_5_submit').disabled = true;
                    var serialized = _form_serialize(document.getElementById('_form_5_'));
              var err = form_to_submit.querySelector('._form_error');
              err ? err.parentNode.removeChild(err) : false;
              _load_script('https://maciejkusz.activehosted.com/proc.php?' + serialized + '&jsonp=true');
            }
            return false;
          };
          addEvent(form_to_submit, 'submit', form_submit);
        })();

</script></div>
</div>
<aside class="postpromonav">
<nav>
<ul class="tags" itemprop="keywords">
<li><a class="tag p-category" href="../../categories/lambda/" rel="tag">lambda</a></li>
<li><a class="tag p-category" href="../../categories/python/" rel="tag">python</a></li>
<li><a class="tag p-category" href="../../categories/requests/" rel="tag">requests</a></li>
<li><a class="tag p-category" href="../../categories/unittest/" rel="tag">unittest</a></li>
</ul>
<ul class="pager hidden-print">
<li class="previous"><a href="../20201218/najmniejszy-framework-do-testow-w-pythonie/" rel="prev" title="Najmniejszy framework do testÃ³w w Pythonie">Poprzedni post</a></li>
</ul>
</nav>
</aside>
<section class="comments hidden-print">
<h2>Komentarze</h2>
<div id="disqus_thread"></div>
<script>
        var disqus_shortname ="testerembyc",
            disqus_url="https://testerembyc.pl/posts/jeszcze-mniejszy-framework-do-testow-w-pythonie/",
        disqus_title="Jeszcze mniejszy framework do test\u00f3w w Pythonie",
        disqus_identifier="cache/posts/jeszcze-mniejszy-framework-do-testow-w-pythonie.html",
        disqus_config = function () {
            this.language = "pl";
        };
        (function() {
            var dsq = document.createElement('script'); dsq.async = true;
            dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
</script><noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript> <a class="dsq-brlink" href="https://disqus.com" rel="nofollow">Comments powered by <span class="logo-disqus">Disqus</span></a></section>
</article>
<script>
var disqus_shortname="testerembyc";(function(){var a=document.createElement("script");a.async=true;a.src="https://"+disqus_shortname+".disqus.com/count.js";(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(a)}());
</script></div>
<div class="col-sm-3 blog-sidebar">
<div class="sidebar-module sidebar-module-inset">
<form action="https://www.google.com/search" method="get" role="search"><input name="cx" type="hidden" value="013548426528546093847:kxj9yxvrzlu"><input name="ie" type="hidden" value="utf-8"><input name="hl" type="hidden" value="pl">
<div class="input-group"><input aria-describedby="basic-search" class="form-control" name="q" placeholder="Szukaj" type="text">
<div class="input-group-btn"><button class="btn btn-danger" type="submit"><span class="glyphicon glyphicon-search" id="basic-search"></span></button></div>
</div>
<input name="sitesearch" type="hidden" value="testerembyc"></form>
</div>
<div class="sidebar-module sidebar-module-inset">
<h3>Darmowy poradnik</h3>
<a href="../../pages/jak-zaczac-automatyzowac-testy/"><img src="../../images/page_lm/jak_zaczac_automatyzowac_small.jpg"></a>
<p><strong>Jak zaczÄ…Ä‡ automatyzowaÄ‡ testy?</strong></p>
<p>Poznaj 12 pytaÅ„, ktÃ³re pomogÄ… Ci rozpoczÄ…Ä‡ proces automatyzacji testÃ³w. W zupeÅ‚nym oderwaniu od jÄ™zyka programowania, frameworkÃ³w do testÃ³w oraz technologi w jakiej napisana zostaÅ‚a aplikacja, ktÃ³rÄ… bÄ™dziesz testowaÄ‡. CaÅ‚oÅ›Ä‡ opisana prostym i zrozumiaÅ‚ym jÄ™zykiem.</p>
<p style="text-align: center"><a class="_submit btn btn-danger" href="../../pages/jak-zaczac-automatyzowac-testy/">Pobieram poradnik</a></p>
</div>
<div class="sidebar-module sidebar-module-inset">
<h3>O mnie</h3>
<a href="../../pages/o-mnie/"><img src="../../images/me_bw_small.jpg"></a>
<p>Nazywam siÄ™ <strong>Maciej Kusz</strong> i od 2008 roku zajmujÄ™ siÄ™ testowaniem oprogramowania. Na poczÄ…tku byÅ‚y to testy manualne, od 2011 poczÄ…tki testÃ³w automatycznych, a od 2013 automatyzacjÄ… testÃ³w z wykorzystaniem <strong>Pythona</strong>. Przez te kilka lat, zdarzyÅ‚o mi siÄ™ juÅ¼ byÄ‡ w kilku firmach i w kilku rÃ³Å¼nych projektach. Na stronie <a href="../../pages/o-mnie/">o mnie</a>, znajdujdziesz ciut wiÄ™cej informacji na ten temat.</p>
</div>
<div class="sidebar-module sidebar-module-inset">
<form action="https://maciejkusz.activehosted.com/proc.php" id="_form_3_" method="post" name="_form_3_" novalidate=""><input name="u" type="hidden" value="3"><input name="f" type="hidden" value="3"><input name="s" type="hidden"><input name="c" type="hidden" value="0"><input name="m" type="hidden" value="0"><input name="act" type="hidden" value="sub"><input name="v" type="hidden" value="2">
<h3>Newsletter</h3>
<div class="_form-content">
<p>Chcesz byÄ‡ powiadamiany o nowoÅ›ciach na tej stronie oraz innych moich projektach?</p>
<p>JeÅ›li tak, to zapisz siÄ™ poniÅ¼ej do newsletter'a.</p>
<div class="input-group" id="basic-fullname-group"><span class="input-group-addon" id="basic-fullname">ImiÄ™</span> <input aria-describedby="basic-fullname" class="form-control" name="fullname" placeholder="Wpisz swoje imiÄ™" type="text"></div>
<div class="input-group" id="basic-lastname-group"><span class="input-group-addon" id="basic-lastname">Nazwisko</span> <input aria-describedby="basic-fullname" class="form-control" name="lastname" placeholder="Wpisz swoje nazwisko" type="text"></div>
<div class="input-group" id="basic-email-group"><span class="input-group-addon" id="basic-email">E-mail</span> <input aria-describedby="basic-email" class="form-control" name="email" placeholder="Wpisz swÃ³j e-mail" required="" type="text"></div>
<button class="_submit btn btn-danger" id="_form_3_submit" style="margin-left: auto; margin-right: auto; display: block;" type="submit">Zapisz siÄ™</button>
<div class="_clear-element"></div>
</div>
<div class="_form-thank-you" style="display:none;"></div>
<p style="font-size: 10px; margin-top: 5px;">Wszystkie podane przez Ciebie dane, bÄ™dÄ… przetwarzane zgodnie z <a href="../../pages/polityka-prywatnosci">politykÄ… prywatnoÅ›ci</a>.</p>
</form>
<script type="text/javascript">
window.cfields = [];
window._show_thank_you = function(id, message, trackcmp_url) {
  var form = document.getElementById('_form_' + id + '_'), thank_you = form.querySelector('._form-thank-you');
  form.querySelector('._form-content').style.display = 'none';
  thank_you.innerHTML = message;
  thank_you.style.display = 'block';
  if (typeof(trackcmp_url) != 'undefined' && trackcmp_url) {
    // Site tracking URL to use after inline form submission.
    _load_script(trackcmp_url);
  }
  if (typeof window._form_callback !== 'undefined') window._form_callback(id);
};
window._show_error = function(id, message, html) {
  var form = document.getElementById('_form_' + id + '_'), err = document.createElement('div'), button = form.querySelector('button'), old_error = form.querySelector('._form_error');
  if (old_error) old_error.parentNode.removeChild(old_error);
  err.innerHTML = message;
  err.className = '_error-inner _form_error _no_arrow';
  var wrapper = document.createElement('div');
  wrapper.className = '_form-inner';
  wrapper.appendChild(err);
  button.parentNode.insertBefore(wrapper, button);
  document.querySelector('[id^="_form"][id$="_submit"]').disabled = false;
  if (html) {
    var div = document.createElement('div');
    div.className = '_error-html';
    div.innerHTML = html;
    err.appendChild(div);
  }
};
window._load_script = function(url, callback) {
    var head = document.querySelector('head'), script = document.createElement('script'), r = false;
    script.type = 'text/javascript';
    script.charset = 'utf-8';
    script.src = url;
    if (callback) {
      script.onload = script.onreadystatechange = function() {
      if (!r && (!this.readyState || this.readyState == 'complete')) {
        r = true;
        callback();
        }
      };
    }
    head.appendChild(script);
};
(function() {
  if (window.location.search.search("excludeform") !== -1) return false;
  var getCookie = function(name) {
    var match = document.cookie.match(new RegExp('(^|; )' + name + '=([^;]+)'));
    return match ? match[2] : null;
  }
  var setCookie = function(name, value) {
    var now = new Date();
    var time = now.getTime();
    var expireTime = time + 1000 * 60 * 60 * 24 * 365;
    now.setTime(expireTime);
    document.cookie = name + '=' + value + '; expires=' + now + ';path=/';
  }
      var addEvent = function(element, event, func) {
    if (element.addEventListener) {
      element.addEventListener(event, func);
    } else {
      var oldFunc = element['on' + event];
      element['on' + event] = function() {
        oldFunc.apply(this, arguments);
        func.apply(this, arguments);
      };
    }
  }
  var _removed = false;
  var form_to_submit = document.getElementById('_form_3_');
  var allInputs = form_to_submit.querySelectorAll('input, select, textarea'), tooltips = [], submitted = false;

  var getUrlParam = function(name) {
    var regexStr = '[\?&]' + name + '=([^&#]*)';
    var results = new RegExp(regexStr, 'i').exec(window.location.href);
    return results != undefined ? decodeURIComponent(results[1]) : false;
  };

  for (var i = 0; i < allInputs.length; i++) {
    var regexStr = "field\[(\d+)\]";
    var results = new RegExp(regexStr).exec(allInputs[i].name);
    if (results != undefined) {
      allInputs[i].dataset.name = window.cfields[results[1]];
    } else {
      allInputs[i].dataset.name = allInputs[i].name;
    }
    var fieldVal = getUrlParam(allInputs[i].dataset.name);

    if (fieldVal) {
      if (allInputs[i].type == "radio" || allInputs[i].type == "checkbox") {
        if (allInputs[i].value == fieldVal) {
          allInputs[i].checked = true;
        }
      } else {
        allInputs[i].value = fieldVal;
      }
    }
  }

  var remove_tooltips = function() {
    for (var i = 0; i < tooltips.length; i++) {
      tooltips[i].tip.parentNode.removeChild(tooltips[i].tip);
    }
      tooltips = [];
  };
  var remove_tooltip = function(elem) {
    for (var i = 0; i < tooltips.length; i++) {
      if (tooltips[i].elem === elem) {
        tooltips[i].tip.parentNode.removeChild(tooltips[i].tip);
        tooltips.splice(i, 1);
        return;
      }
    }
  };
  var create_tooltip = function(elem, text) {
    var tooltip = document.createElement('label'), arrow = document.createElement('div'), inner = document.createElement('div'), new_tooltip = {};
    if (elem.type != 'radio' && elem.type != 'checkbox') {
      tooltip.className = 'label label-danger';
      tooltip.innerHTML = text;
      elem.parentNode.parentNode.insertBefore(tooltip, elem.parentNode);
    } else {
      tooltip.className = '_error-inner _no_arrow';
      tooltip.innerHTML = text;
      elem.parentNode.insertBefore(tooltip, elem);
      new_tooltip.no_arrow = true;
    }
    new_tooltip.tip = tooltip;
    new_tooltip.elem = elem;
    tooltips.push(new_tooltip);
    return new_tooltip;
  };
  var resize_tooltip = function(tooltip) {
    var rect = tooltip.elem.getBoundingClientRect();
    var doc = document.documentElement, scrollPosition = rect.top - ((window.pageYOffset || doc.scrollTop)  - (doc.clientTop || 0));
    if (scrollPosition < 40) {
      tooltip.tip.className = tooltip.tip.className.replace(/ ?(_above|_below) ?/g, '') + ' _below';
    } else {
      tooltip.tip.className = tooltip.tip.className.replace(/ ?(_above|_below) ?/g, '') + ' _above';
    }
  };
  var resize_tooltips = function() {
    if (_removed) return;
    for (var i = 0; i < tooltips.length; i++) {
      if (!tooltips[i].no_arrow) resize_tooltip(tooltips[i]);
    }
  };
  var validate_field = function(elem, remove) {
    var tooltip = null, value = elem.value, no_error = true;
    remove ? remove_tooltip(elem) : false;
    if (elem.type != 'checkbox') elem.className = elem.className.replace(/ ?_has_error ?/g, '');
    if (elem.getAttribute('required') !== null) {
      if (elem.type == 'radio' || (elem.type == 'checkbox' && /any/.test(elem.className))) {
        var elems = form_to_submit.elements[elem.name];
        if (!(elems instanceof NodeList || elems instanceof HTMLCollection) || elems.length <= 1) {
          no_error = elem.checked;
        }
        else {
          no_error = false;
          for (var i = 0; i < elems.length; i++) {
            if (elems[i].checked) no_error = true;
          }
        }
        if (!no_error) {
          tooltip = create_tooltip(elem, "Wybierz opcjÄ™.");
        }
      } else if (elem.type =='checkbox') {
        var elems = form_to_submit.elements[elem.name], found = false, err = [];
        no_error = true;
        for (var i = 0; i < elems.length; i++) {
          if (elems[i].getAttribute('required') === null) continue;
          if (!found && elems[i] !== elem) return true;
          found = true;
          elems[i].className = elems[i].className.replace(/ ?_has_error ?/g, '');
          if (!elems[i].checked) {
            no_error = false;
            elems[i].className = elems[i].className + ' _has_error';
            err.push("Zaznaczenie %s jest wymagane".replace("%s", elems[i].value));
          }
        }
        if (!no_error) {
          tooltip = create_tooltip(elem, err.join('<br/>'));
        }
      } else if (elem.tagName == 'SELECT') {
        var selected = true;
        if (elem.multiple) {
          selected = false;
          for (var i = 0; i < elem.options.length; i++) {
            if (elem.options[i].selected) {
              selected = true;
              break;
            }
          }
        } else {
          for (var i = 0; i < elem.options.length; i++) {
            if (elem.options[i].selected && !elem.options[i].value) {
              selected = false;
            }
          }
        }
        if (!selected) {
          elem.className = elem.className + ' _has_error';
          no_error = false;
          tooltip = create_tooltip(elem, "Wybierz opcjÄ™.");
        }
      } else if (value === undefined || value === null || value === '') {
        elem.className = elem.className + ' _has_error';
        no_error = false;
        tooltip = create_tooltip(elem, "To pole jest wymagane.");
      }
    }
    if (no_error && elem.name == 'email') {
      if (!value.match(/^[\+_a-z0-9-'&=]+(\.[\+_a-z0-9-']+)*@[a-z0-9-]+(\.[a-z0-9-]+)*(\.[a-z]{2,})$/i)) {
        elem.className = elem.className + ' _has_error';
        no_error = false;
        tooltip = create_tooltip(elem, "Wpisz poprawny adres e-mail.");
      }
    }
    if (no_error && /date_field/.test(elem.className)) {
      if (!value.match(/^\d\d\d\d-\d\d-\d\d$/)) {
        elem.className = elem.className + ' _has_error';
        no_error = false;
        tooltip = create_tooltip(elem, "Wpisz poprawnÄ… datÄ™.");
      }
    }
    tooltip ? resize_tooltip(tooltip) : false;
    return no_error;
  };
  var needs_validate = function(el) {
    return el.name == 'email' || el.getAttribute('required') !== null;
  };
  var validate_form = function(e) {
    var err = form_to_submit.querySelector('._form_error'), no_error = true;
    if (!submitted) {
      submitted = true;
      for (var i = 0, len = allInputs.length; i < len; i++) {
        var input = allInputs[i];
        if (needs_validate(input)) {
          if (input.type == 'text') {
            addEvent(input, 'blur', function() {
              this.value = this.value.trim();
              validate_field(this, true);
            });
            addEvent(input, 'input', function() {
              validate_field(this, true);
            });
          } else if (input.type == 'radio' || input.type == 'checkbox') {
            (function(el) {
              var radios = form_to_submit.elements[el.name];
              for (var i = 0; i < radios.length; i++) {
                addEvent(radios[i], 'click', function() {
                  validate_field(el, true);
                });
              }
            })(input);
          } else if (input.tagName == 'SELECT') {
            addEvent(input, 'change', function() {
              validate_field(this, true);
            });
          } else if (input.type == 'textarea'){
            addEvent(input, 'input', function() {
              validate_field(this, true);
            });
          }
        }
      }
    }
    remove_tooltips();
    for (var i = 0, len = allInputs.length; i < len; i++) {
      var elem = allInputs[i];
      if (needs_validate(elem)) {
        if (elem.tagName.toLowerCase() !== "select") {
          elem.value = elem.value.trim();
        }
        validate_field(elem) ? true : no_error = false;
      }
    }
    if (!no_error && e) {
      e.preventDefault();
    }
    resize_tooltips();
    return no_error;
  };
  addEvent(window, 'resize', resize_tooltips);
  addEvent(window, 'scroll', resize_tooltips);
  window._old_serialize = null;
  if (typeof serialize !== 'undefined') window._old_serialize = window.serialize;
  _load_script("//d3rxaij56vjege.cloudfront.net/form-serialize/0.3/serialize.min.js", function() {
    window._form_serialize = window.serialize;
    if (window._old_serialize) window.serialize = window._old_serialize;
  });
  var form_submit = function(e) {
    e.preventDefault();
    if (validate_form()) {
      // use this trick to get the submit button & disable it using plain javascript
      document.querySelector('#_form_3_submit').disabled = true;
            var serialized = _form_serialize(document.getElementById('_form_3_'));
      var err = form_to_submit.querySelector('._form_error');
      err ? err.parentNode.removeChild(err) : false;
      _load_script('https://maciejkusz.activehosted.com/proc.php?' + serialized + '&jsonp=true');
    }
    return false;
  };aw
  addEvent(form_to_submit, 'submit', form_submit);
})();

</script></div>
<div class="sidebar-module sidebar-module-inset">
<h3>Linki</h3>
<ol class="list-unstyled">
<li><a href="../../pages/polityka-prywatnosci/">Polityka prywatnoÅ›ci</a></li>
<li><a href="../../pages/regulamin/">Regulamin</a></li>
</ol>
<ol class="list-unstyled icons">
<li><a class="far fa-envelope" href="mailto:maciej@testerembyc.pl" target="_bland"></a></li>
<li><a class="fab fa-facebook-f" href="https://www.facebook.com/testerembyc/" target="_blank"></a></li>
<li><a class="fab fa-instagram" href="https://www.instagram.com/testerembyc/" target="_blank"></a></li>
<li><a class="fab fa-linkedin-in" href="https://www.linkedin.com/in/maciej-kusz/" target="_blank"></a></li>
</ol>
</div>
</div>
<!--End of body content--></div>
</div>
<footer class="blog-footer" id="footer">Â© 2021 <span style="font-weight: bold; color: #ffffff;">Maciej Kusz</span> w oparciu o silnik <a href="https://getnikola.com/" rel="nofollow" target="_blank"><img src="../../images/nikola_logo.svg" style="max-height: 20px; max-width: 50px"></a> z wykorzystaniem <a href="https://pages.github.com/" rel="nofollow" target="_blank"><img src="../../images/githubpages_logo.svg" style="max-height: 15px; max-width: 80px;"></a></footer>
</div>
</div>
<script type="text/javascript">
/*
 * Bootstrap Cookie Alert by Wruczek
 * https://github.com/Wruczek/Bootstrap-Cookie-Alert
 * Released under MIT license
 */
(function () {
    "use strict";

    var cookieAlert = document.querySelector(".cookiealert");
    var acceptCookies = document.querySelector(".acceptcookies");

    if (!cookieAlert) {
       return;
    }


    // Show the alert if we cant find the "acceptCookies" cookie
    if (!getCookie("acceptCookies")) {
        cookieAlert.classList.add("show");
    } else {
        cookieAlert.classList.remove("show")
    }

    // When clicking on the agree button, create a 1 year
    // cookie to remember user's choice and close the banner
    acceptCookies.addEventListener("click", function () {
        setCookie("acceptCookies", true, 365);
        cookieAlert.classList.remove("show");
    });

    // Cookie functions from w3schools
    function setCookie(cname, cvalue, exdays) {
        var d = new Date();
        d.setTime(d.getTime() + (exdays * 24 * 60 * 60 * 1000));
        var expires = "expires=" + d.toUTCString();
        document.cookie = cname + "=" + cvalue + ";" + expires + ";path=/";
    }

    function getCookie(cname) {
        var name = cname + "=";
        var decodedCookie = decodeURIComponent(document.cookie);
        var ca = decodedCookie.split(';');
        for (var i = 0; i < ca.length; i++) {
            var c = ca[i];
            while (c.charAt(0) === ' ') {
                c = c.substring(1);
            }
            if (c.indexOf(name) === 0) {
                return c.substring(name.length, c.length);
            }
        }
        return "";
    }
})();
</script>
<script src="../../assets/js/jquery.min.js">
</script>
<script src="../../assets/js/bootstrap.min.js">
</script>
<script src="../../assets/js/baguetteBox.min.js">
</script>
<script src="../../assets/js/moment-with-locales.min.js">
</script>
<script src="../../assets/js/fancydates.min.js">
</script><!-- fancy dates -->
<script>
    moment.locale("pl");
    fancydates(0, "YYYY-MM-DD HH:mm");
</script><!-- end fancy dates -->
<script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
</script><!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-143859058-1">
</script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-143859058-1');
</script><!-- Load Facebook SDK for JavaScript -->
<div id="fb-root"></div>
<script>
  window.fbAsyncInit = function() {
    FB.init({
      xfbml            : true,
      version          : 'v3.3'
    });
  };

  (function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = 'https://connect.facebook.net/pl_PL/sdk/xfbml.customerchat.js';
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));
</script><!-- Your customer chat code -->
<div attribution="setup_tool" class="fb-customerchat" logged_in_greeting="Witaj! JeÅ›li chcesz dowiedzieÄ‡ siÄ™ czegoÅ› wiÄ™cej, to zapraszam do rozmowy ;)" logged_out_greeting="Witaj! JeÅ›li chcesz dowiedzieÄ‡ siÄ™ czegoÅ› wiÄ™cej, to zapraszam do rozmowy ;)" page_id="391052181505294" theme_color="#337ab7"></div>
<!-- Facebook Pixel Code -->
<script>
  !function(f,b,e,v,n,t,s)
  {if(f.fbq)return;n=f.fbq=function(){n.callMethod?
  n.callMethod.apply(n,arguments):n.queue.push(arguments)};
  if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
  n.queue=[];t=b.createElement(e);t.async=!0;
  t.src=v;s=b.getElementsByTagName(e)[0];
  s.parentNode.insertBefore(t,s)}(window, document,'script',
  'https://connect.facebook.net/en_US/fbevents.js');
  fbq('init', '444619046317574');
  fbq('track', 'PageView');
</script><noscript><img alt="Facebook Pixel" height="1" src="https://www.facebook.com/tr?id=444619046317574&amp;ev=PageView&amp;noscript=1" style="display:none" width="1"></noscript> <!-- End Facebook Pixel Code -->
</body>
</html>
